Grigory Kislin [7:16 AM]
joined #hw8.

Grigory Kislin [7:17 AM]
Как и обещал, в 8м уроке: CSS (Bootstrap), JavaScript (jQuery + plugins), AJAX
+ добавление к REST контроллерам базовой авторизации (в UI и тесты добавим на следующем уроке)
https://github.com/JavaWebinar/topjava/blob/doc/doc/lesson08.md
Успехов! (edited)

Constantine [7:19 AM]
joined #hw8 along with 8 others.

Ilya [8:11 AM]
Я один не могу патчи выкачать ?

This site can’t be reached
takeout.google.com refused to connect.
Try:

Checking the connection
Checking the proxy and the firewall
ERR_CONNECTION_REFUSED
мдам, только vpn спасает :confused: видать последствия маразма ркн

Alexander_Gubanow [8:15 AM]
joined #hw8 along with 9 others.

pro [9:13 AM]
хорошо, что vpn еще не прикрыли) любая война людей с людьми по большому счету - маразм; интересно, на сколько лет бы люди могли законсервировать энергетические сырьевые месторождения, возьмись они кидать в "топку" свои заготовленные ракеты

realcorwin [10:30 AM]
никто не заставляет Гугл помогать телеграмм обходить законы

Dzmitry Shalukhau [10:31 AM]
@realcorwin проблема не в этом, а в том. что никто не заставляет РКН думать и отвечать за промахи
Гугл не помогает - он просто предоставляет сервис всем. А люди из-за тупых блокировок теряют деньги (время/силы/бизнес)

realcorwin [10:33 AM]
это не тупые блокировки. это исполнение закона. которые призван уберечь людей
впрочем, это флуд здесь

Dzmitry Shalukhau [10:33 AM]
Именно, что тупые. Если бы были не тупые - блокировали бы конкретные ресурсы, а не массово. В общем, во флуд


Valery.Shkerdin [10:37 AM]
#flooding вам туда )

Grigory Kislin [10:39 AM]
*добавил еще мелкие правки - патч: 8_10_fix.patch*
*https://drive.google.com/open?id=1VWBMA2Kd6Jq5DAWYJkzwlHjWHFeFc80F* (edited)


Dmitry Neustupov [3 days ago]
У меня одного 404 по ссылке?


Zhivchik [2 days ago]
у меня тоже


realcorwin [2 days ago]
https://drive.google.com/drive/folders/0B9Ye2auQ_NsFfjZuOHczMzBHX2p1RXBFZWdISS1zTFZqYzYzSzA4dk9tb0N5ZkFUUW44YjQ


Grigory Kislin [2 days ago]
ссылку поправил. гугл чтото глючит. а так- да, вместе со всеми патчами лежит


aleksey [3:35 PM]
Следующее занятие будет по расписанию?


Grigory Kislin [Apr 26th at 4:40 PM]
in #hw8
все по расписанию


1 reply
Vyacheslav [2 days ago]
Товарищ лектор. Нужно ли ждать письмо на почту, или можно патчи из этого урока накатывать?


Vyacheslav [6:27 PM]
Архив не создается, но патчи можно выкачать по одному? Там еще icon-meal.png лежит. Он нужен?

Yevhen Maksymovych [8:12 PM]
Григорий, а доступ к папкам после окончания стажировки останется? я, как, думаю, и большинство, ролики смотрю, но часть материала текстового оставляю на "авось потом перечитаю", а щаз подумал, что половина стажировки-то уже прошла, и перечитывать уже скоро может стать нечего


Dmitry Neustupov [2 days ago]
останется


Grigory Kislin [1 day ago]
да, все останется на google drive
как в папке topjava12


qf05 [Apr 26th at 8:19 PM]
in #hw8
а это нормально, что кнопка edit не работает?


1 reply
Dmitry Neustupov [2 days ago]
нормально


qf05 [Apr 26th at 8:37 PM]
in #hw8
поясните пожалуйста, id элемента должно быть уникально на странице или во всём проекте? например можно ли использовать в meal.jsp id=editRow если такой же id используется в user.jsp?


2 replies
Oleksii Leshchenko [2 days ago]
Id уникальный на весь проект - один сиквенс в БД на все


tema.emelyan [2 days ago]
На странице


alexey [Apr 26th at 9:25 PM]
in #hw8
народ а версия  spring-security-web в pom.xml  у всех светится  красным или только у меня? и в security.xml половина кода красная (edited)


3 replies
Эрик [1 day ago]
а какая версия у тебя прописана?
Reimport all maven projects не помогает?


alexey [1 day ago]
там версия от спринга стоит. Пробовал не помогло


alexey [1 day ago]
Решилось откатом на насколько патчей назад)


SergeyMuratkin [5:34 PM]
Нет, у меня  нормально всё. security.xml нет такого файла мы меняли его на spring-security.xml
alexey
народ а версия  spring-security-web в pom.xml  у всех светится  красным или только у меня? и в security.xml половина кода красная
Posted in #hw8Apr 26th


Ma3stro [Yesterday at 5:41 AM]
in #hw8
Как не сойти с ума от передоза новой информации и непонятных конструкций? .-._-._-.


1 reply
Fedor [2 hours ago]
Знакомо это. Я делаю шаг в сторону, смотрю бегло какой нибудь курс по новой теме, потом возвращаюсь. Видео курсы легче воспринимаются, чем скакание по ссылкам


aleksey [5:51 AM]
@Ma3stro и молись чтобы тебе не пришлось работать с фронтэндом на тех технологиях которым тут учат.

V-E-S-T [9:33 AM]
а на каких технологиях лучше работать с фронтэндом? какая связка с java бэкэндом предпочтительнее на ваш взгляд?


alexey [Yesterday at 9:37 AM]
in #hw8
Доброе утро. Народ подскажите в datatablesUtil.js функция save будет ведь одинаковая и для user и для meal?


1 reply
Zhivchik [15 hours ago]
Да. В datatablesUtil.js находятся общие скрипты


aleksey [10:29 AM]
@V-E-S-T чаще всего вместе с Java используют Angular. Я неплохо знаю vueJs, в кратце с тех пор как писался этот курс на фронте уже пару раз все с ног на голову перевернулось и инструменты и современный подход к построению приложений гораздо удобнее.


Zhivchik [10:52 AM]
added and commented on this Plain Text snippet: Untitled 
Т.к. HTML атрибут id у каждого элемента документа должен быть уникален, нужно избавиться от дублирования id="${user.id}" в строках таблиц users и meals
Это имеется в виду дублирование id в ссылках ячеек update и delete?

realcorwin [11:39 AM]
Сейчас вроде Angular с TypeScript используют. Файн книжку написал, скоро второе издание выйти должно
https://www.manning.com/books/angular-development-with-typescript-second-edition
Manning Publications
Angular Development with Typescript, Second Edition
A very fine update on developing top-grade applications with Angular using TypeScript.
https://images.manning.com/720/960/resize/book/4/b5c65d8-4ddb-4bf6-ae79-d37f84e9bbc6/Fain-Angular-2ed-MEAP-HI.png
недавно Немчинский лекцию про сравнение стеков J2EE и спринга читал. суть была в том, что юниоры гораздо быстрее въезжают в J2EE, чем в спринг. во многом и потому, что у J2EE своя морда есть, а у спринга - нет

tema.emelyan [11:54 AM]
мне кажется тут не было цели использовать передовые технологии фрон енд разработки, курс по беку всё-таки. целый фронт фрейм-ворк цеплять сюда это уже через чур наверное. а jquery как раз самый минимум, чтобы хоть что-то было.


dustnfox [Yesterday at 1:33 PM]
in #hw8
Друзья, что сие означает?
>Реализовать добавление записи еды через модальное окно Bootstrap и удаление еды по ajax _(БЕЗ редактирования)_
Нам нужно update для еды реализовывать или как? Просто следующий пункт про дублирование id HTML, а он имеет смысл только если делать edit.


7 replies
Oleksii Leshchenko [11 hours ago]
> добавление записи еды через модальное окно Bootstrap
У Бутсрап есть возможность создать свои кастомные формы. Т.е. создать свое диалоговое окно. Оно спрятано до поры до времени. При нажатии на кнопку появляется...


Oleksii Leshchenko [11 hours ago]
> удаление еды по ajax
при нажатии на кнопку Delete должен отправлять ajax-запрос


dustnfox [11 hours ago]
Да это все вроде как понятно.  Уточнение про _без редактирования_ что означает в данном контексте?


Oleksii Leshchenko [11 hours ago]
Думаю, редактирование вообще не имплементить. Там же у нас отдельная кнопка)


dustnfox [11 hours ago]
Ну так да. Вот я и понять не могу, к чему это было написано? То ли, что вообще не нужно update делать на еду пока, то ли что-то другое.  Просто дальше в задании про фильтр и enable юзеров. Про update ни слова. Нужна его реализация через AJAX или нет, так и не понял.


Oleksii Leshchenko [11 hours ago]
скорее всего не надо трогать вообще


dustnfox [11 hours ago]
@Oleksii Leshchenko ок. Спасибо!


dmitry_ov [Yesterday at 1:51 PM]
in #hw8
Коллеги, подскажите как проект запустить:
Выполняю в maven cargo:run
Ожидаю что соберется war файл и запустится в tomcat
Вместо этого вижу сообщение от cargo-maven2-plugin такого содержания:
Failed to find file […/topjava/target/topjava.war]

т.е. war файл не был создан
Что я делаю не так ? (edited)


3 replies
Oleksii Leshchenko [11 hours ago]
попробуй сделать clean и пересобрать проект


dmitry_ov [11 hours ago]
Сделал  clean,  compile,  package. war появился !
Спасибо (edited)


dustnfox [11 hours ago]
В любой непонятной ситуации делайте mvn:clean :grin:


Slav [3:21 PM]
Друзья, при переходе на страницу users получаю следующую ошибку:
Message javax.servlet.ServletException: javax.servlet.jsp.JspTagException: No message found under code 'common.add' for locale 'ru'.

Почему не находит 'common.add' для кнопки? 
К статье, 'common.select' находит.


poleg [Yesterday at 5:41 PM]
in #hw8
8_7_add_security.mp4 8:45 - так почему юзера-то пропустил? Не должен ведь.


1 reply
realcorwin [1 hour ago]
Рискну предположить, по этой причине: путь в intercept-url должен быть полный: pattern="/rest/admin/**"


V-E-S-T [7:24 PM]
спасибо всем кто отписал мнения.


Ma3stro [Yesterday at 10:52 AM]
in #hw8
почему при удалении юзера (или любых других действий) у нас именно на ajax контроллер прилетает, где мы эт указали? (edited)


2 replies
Aleksei Kirillov [1 day ago]
Посмотри константу в userDatatables.js


Ma3stro [1 day ago]
Да, уже по-тихоньку разбираюсь:)


Oleksii Leshchenko [5:43 PM]
uploaded and commented on this image: image.png 

Если уменьшить окно браузера, то разметка немного слетает. Видно, если вся таблица не умещается и прокрутить прокрутку вправа... 
При полноэкранном режиме такого нет.

Yevhen Maksymovych [6:07 PM]
странно
у меня не слетает

Yevhen Maksymovych [6:08 PM]
uploaded this image: image.png 


Yevhen Maksymovych [6:08 PM]
ну только спаны с инпутфилдами разъезжаются в отдельные строки

Yevhen Maksymovych [6:08 PM]
uploaded this image: image.png 


Oleksii Leshchenko [6:13 PM]
@Yevhen Maksymovych А на странице Пользовтели?

Yevhen Maksymovych [6:25 PM]
тоже норм всё


Yevhen Maksymovych [Yesterday at 6:57 PM]
in #hw8
а зачем мы в модальной форме на спанах с иконками дополнительно указываем
```aria-hidden="true"```


3 replies
Grigory Kislin [23 hours ago]
можно убрать, роли не играет. погугли, если интересно (edited)


Yevhen Maksymovych [17 hours ago]
да я погуглил, так понял, что это accessible-опция для всяких скрин-ридеров, что элемент при чтении экрана не произносится. потому и удивился, почему мы принудительно его указали :slightly_smiling_face:


Grigory Kislin [7 hours ago]
во всех примерах обычно с ним


Yevhen Maksymovych [6:57 PM]
?

Oleksii Leshchenko [7:16 PM]
У меня при ajax-запросе на добавление еды вылетает ошибка *HTTP Status 415 Unsupported Media Type* если метод в контроллере определен так:
`@PostMapping`
   `public void createWithLocation(@RequestBody Meal meal) {`
А если так, то все работает:
   `@PostMapping`
   `public void createWithLocation(@RequestParam("id") Integer id,`
                                  `@RequestParam("dateTime") @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME) LocalDateTime dateTime,`
                                  `@RequestParam("description") String description,`
                                  `@RequestParam("calories") Integer calories ) {`
При этом без @DateTimeFormat не работат о ошибка 400

Yevhen Maksymovych [7:21 PM]
так и должно быть
мы же отключили стандартные форматтеры
а собственные добавили только отдельно на локалдейт и локалтайм
так что надо либо добавлять свой на локалдэйттайм, либо указывать через @DateTimeFormat что мы пользуем стандартный

Yevhen Maksymovych [7:47 PM]
а вот так работать и не будет
````@PostMapping`
   `public void createWithLocation(@RequestBody Meal meal) {```


Yevhen Maksymovych [Yesterday at 7:49 PM]
in #hw8
насколько я понимаю, чтобы корректно сериализовать форму в json-объект надо ещё подкрутить руками


2 replies
Grigory Kislin [23 hours ago]
а зачем форму в json передавать?


Yevhen Maksymovych [17 hours ago]
там Алексей сверху хотел из RequestBody получить целый Meal, в то вермя как мы отправляли через ajax сериализованную форму, я к тому написал, что можно собрать данные формы в Meal json и передать целиком, но придётся делать это руками


Yevhen Maksymovych [8:13 PM]
https://stackoverflow.com/questions/11338774/serialize-form-data-to-json
stackoverflow.com
Serialize form data to JSON
I want to do some pre-server-validation of a form in a Backbone.js model. To do this I need to get the user input from a form into usable data. I found three methods to do this: var input = $("#i...

Oleksii Leshchenko [9:12 PM]
Интересно, Datatable js локализована?

Yevhen Maksymovych [9:25 PM]
можешь сам локализовать
https://datatables.net/reference/option/language

Yevhen Maksymovych [11:49 AM]
кстати, локализуется довольно просто: качаешь нужный лангпак с сайта, кладёшь его к ресурсам в папку, а затем проверяешь navigator.language и подставляешь нужный пак в опции datatables

roma [8:55 PM]
Друзья пару вопросов есть )
1) данные в модальном окне добавляются все гуд - а аякс не српабатывает не понимаю почему - делал все как в юзерах было... Если обновить страницу - то новые данные отображаются
2) с DELETE тажа фигня
```var ajaxMealUrl = "ajax/meals/";
var mealDatatableApi;

// $(document).ready(function () {
$(function () {
    mealDatatableApi = $("#mealdatatable").DataTable({
        "paging": false,
        "info": true,
        "columns": [
            {
                "data": "date_time"
            },
            {
                "data": "description"
            },
            {
                "data": "calories"
            },
            {
                "defaultContent": "Edit",
                "orderable": false
            },
            {
                "defaultContent": "Delete",
                "orderable": false
            }
        ],
        "order": [
            [
                0,
                "desc"
            ]
        ]
    });
    makeEditableMeals();
});```
и фрагмент второго файла
```function deleteRow(id) {
    $.ajax({
        url: ajaxMealUrl + id,
        type: "DELETE",
        success: function () {
            updateMealTable();
            successNoty("Deleted");
        }
    });
}

function updateMealTable() {
    $.get(ajaxMealUrl, function (data) {
        mealDatatableApi.clear().rows.add(data).draw();
    });
}

function saveMeal() {
    var form = $("#detailsMealForm");
    $.ajax({
        type: "POST",
        url: ajaxMealUrl,
        data: form.serialize(),
        success: function () {
            $("#editMealRow").modal("hide");
            updateMealTable();
            successNoty("Saved");
        }
    });
}```


Yevhen Maksymovych [2 hours ago]
покажи гит


Yevhen Maksymovych [2 hours ago]
судя по тому, что данные уходят в БД, но не обновляются на форме, одно из двух: либо сервер не присылает ответ, либо jq некорректно его обрабатывает


Yevhen Maksymovych [2 hours ago]
надо смотреть, что уходит на сервер, и что оттуда приходит. или бряками в js, или инспектором в браузере


Grigory Kislin [1 hour ago]
вкладка Network в браузере- это №1 что надо смотреть


realcorwin [10:07 PM]
@roma попробуй, может, так:

function updateTable() {
   $.get(ajaxUrl, function (data) {
       datatableApi.fnClearTable();
       $.each(data, function (key, item) {
           datatableApi.fnAddData(item);
       });
       datatableApi.fnDraw();
   });

Ma3stro [10:46 PM]
Смотреть скрипт в демо или полностью делать самому? (edited)

Будет ли "честно" сие?


dmitry_ov [Today at 12:13 AM]
in #hw8
Коллеги, помогите с локалями разобраться.
Запустил проект, захожу на страницу кнопку “Пользователи”  http://localhost:8080/topjava/users/ и вижу ошибку:
HTTP Status 500 - javax.servlet.ServletException: javax.servlet.jsp.JspTagException: No message found under code ‘common.add’ for locale ‘ru’.

В файле topjava/config/messages/app_ru.properties  есть строка:  “common.add=Добавить” (edited)


4 replies
Yevhen Maksymovych [17 hours ago]
Переменная TOPJAVA_ROOT не определена или не указывает на корень проекта



dmitry_ov [12 hours ago]
Определена и указывает.   http://localhost:8080/topjava   Работает. И русские надписи показывает


dmitry_ov [11 hours ago]
Проблемы при переходе на  http://localhost:8080/topjava/users/  и  http://localhost:8080/topjava/meals/


dmitry_ov [11 hours ago]
@Grigory Kislin Подскажите куда копать ? 
Я пропустил 2 занятия и взял ваш проект, ветка master, последний коммит “8_10_fix”
Собственно т.к. вашу версию и пытаюсь запускать, у вас должно быть тоже поведение (edited)


roma [10:34 AM]
Всем спасибо победил обновление дататэйбл - о котором писал 2мя сообщениями выше - проблемма была в это строке:
```...  "columns": [
            {
                "data": "date_time"
            }, ...```
поменял на
```"data": "dateTime"```
и все заработало - очень помогло то что сегодня вылетел (вчера такого не было не понимаю почему ))))  js .alert в котором черным по белому было написано
```DataTables warning: table id=mealdatatable - Requested unknown parameter 'date_time' for row 0, column 0. For more information about this error, please see http://datatables.net/tn/4```
Теперь появилиь мелкие вопросы: 
1 - не понимаю от куда datatable берет имена столбцов - на примере dateTime - оно у нас в meals.jsp всплывает только в
```<th><spring:message code="meal.dateTime"/></th>```
и то там ссылка на проперти где присваивается значение
```meal.dateTime=Date/Time```
2 - странно что вчера алерт не летел - alert кидает datatable? (edited)


Dmitry Neustupov [12 hours ago]
1. Названия столбцов - это имена полей в энтити.


Dmitry Neustupov [12 hours ago]
2. Да, может, как обычно "ctrl+f5" нужно было? ) Я теперь первым делом обновляю и смотрю нетворк )



Grigory Kislin [12 hours ago]
1. "data": "dateTime" - отсюда и берет:)
далее приходит json, она по именам колонок заполняет таблицу


Oleksii Leshchenko [7:38 PM]
added and commented on this Java snippet: Untitled 
@PutMapping("/{id}/{enabled}")
  public void updateEnabled(@PathVariable("id") Integer id,
               @PathVariable("enabled") Boolean enabled) {
	}
У меня при такой реализации, когда для обновления флага enabled в пользователе использовался метод POST и переменные передаются в пути все работает. 
А вот в варианте, который щас запосчу вторым сообщением, не работало

Oleksii Leshchenko [7:39 PM]
added and commented on this Java snippet: Untitled 
@PutMapping
  public void updateEnabled(@RequestParam("id") Integer id,
              @RequestParam("enabled") Boolean enabled) {
    super.updateEnabled(id, enabled);
  }
Т.е. метод по прежнему PUT, но переменные уже как параметры запроса.

Oleksii Leshchenko [7:41 PM]
Во втором случае AJAX-запрос выглядил так:


Oleksii Leshchenko [7:41 PM]
added this JavaScript/JSON snippet: Untitled 
$.ajax({
      url: ajaxUrl,
      type: 'PUT',
      data: "id="+$(this).parent().parent().attr("id")+"&enabled="+$(this).is(':checked'),
      success: function(data) {
        alert('User was updated');
      }
    });
Collapse 

Oleksii Leshchenko [7:57 PM]
uploaded and commented on this image: SoapUI.png 

Тот ajax запрос работает только, если передать параметры как обведено на скрине из SoapUI. А если передать как json параметры в той части, где нарисован крест, то переданные параметры контроллер не находит и мой метод в контроллере не вызывается...

Yevhen Maksymovych [8:04 PM]
тут как-то совсем странно
если ты передаешь данные через пут, так и клади их, в реквестбади, а то ты их пытаешься передать в теле запроса как гет-урлу (edited)

Oleksii Leshchenko [8:06 PM]
как их положить в риквест-бади?

Yevhen Maksymovych [8:06 PM]
data: {"id" : id, "enabled" enabled}
но ещё, мне думается, надо будет указать тогда contenttype json, и для метода указать, что он аксептит вот именно такой json
либо делай просто
```url: ajaxUrl+"?id="+$(this).parent().parent().attr("id")+"&enabled="+$(this).is(':checked')```
и тогда id и enabled будут доступны через requestParam
я делал вторым способом
```$.post(ajaxUrl+"reactivate/"+id+"?enabled="+enabled, function () {
            row.attr("data-userEnabled", enabled);
            successNoty(enabled ? "Enabled" : "Disabled")
        });```

Oleksii Leshchenko [8:12 PM]
ясно, спасибо)

Yevhen Maksymovych [8:14 PM]
:+1:


Grigory Kislin [11:21 PM]
@Oleksii Leshchenko в PUT и DELETE сервлеты не видят параметров, которые передаются в теле
соответственно контроллеры тоже не видят
проще всего перейти на POST либо в url запроса передавать (edited)
