Grigory Kislin [1:09 AM]
joined #graduation along with 19 others.

Jan [12:25 PM]
@Grigory Kislin продублируйте дату сдачи проекта в этом чате, пожалуйста. (edited)

Grigory Kislin [12:28 PM]
Cрок сдачи до 07.06. Участникам masterjava: до 01.11 (edited)

Mikhail Makar [12:53 PM]
@Grigory Kislin до 01.11.2018?)


alexey [2:36 PM]
а на проверку до какого нужно сдать?

Oleksii Leshchenko [4:35 PM]
Cрок сдачи до 07.06. Участникам masterjava: до 01.11.
Выше есть сообщение...


Ilya [5:34 AM]
можно глупый вопрос - в задании жирным выделено  - without frontend. Это условие или пожелание ?

qf05 [10:44 AM]
Думаю это условие.
Кто что знает про curl commands? Поделитесь пожалуйста знаниями или ссылками.
Я правильно понимаю, что мы должны отправлять запросы к приложению через командную строку и получать объекты?

Jan [11:13 AM]
Да все верно, а в чем вопрос ?
Скорее представление объектов например в xml или json

Grigory Kislin [4:59 PM]
@Ilya скорее да... если хочется можешь сделать в отдельной ветке
@qf05> Кто что знает про curl commands
у нас будет впереди все. делайте пока то, что прошли (edited)

qf05 [6:47 PM]
ой, я что то затупил походу, думал надо к 1 апреля уже сдать... и если бы не какие то curl commands, думаю успел бы) 
тоесть если я собираюсь пойти на курс masterjava то срок до 1 ноября? Оо


qf05 [Yesterday at 7:54 PM]
in #graduation
Григорий, подскажите пожалуйста, а что считается наиболее затратной операцией: 
есть массив N элементов
1) 10 сортировок этого массива
2) N обращений в базу со слоя репозитория


9 replies
Viktor [1 day ago]
а база какая? и на чем написан слой репо?


Viktor [1 day ago]
какая сортировка?


qf05 [1 day ago]
пусть будет сортировка Collections.sort, а база, незнаю, пусть  HSQLDB например. Но с учётом что эту операцию запрашивает очень очень много юзеров.


qf05 [1 day ago]
слой репо с использованием hibernate, ну как мы сейчас делаем в основном проекте.


Viktor [23 hours ago]
хз, на самом деле постановка вопроса немного странная. Такую бы на собеседовании спросить, мало кто ответит :smiley:
Это как вопрос: есть N груш что тяжелее перебрать 10 груши или собрать N ананасов. (edited)


Viktor [23 hours ago]
по идее сортировка занимает O(N*logN). Обращение в базу константа, т.е. N обращений в базу O(N)
10 из расчетов выбрасывается как константа. Получается все тоже:
- сортировка O(N*logN)
- обращений в базу O(N)
Т.е. обращения в базу быстрее (edited)


aleksey [21 hours ago]
Ну тогда уж можно задать вопрос что у нас там за запросы и в какой структуре индексы хранятся


qf05 [12 hours ago]
я имею ввиду, что у нас в выпускном проекте, много раз обращают внимание на количество запросов к базе, и хочу понять на сколько критично  нагружать базу.
приведу другой пример :
что лучше 
1) достаём из базы две коллекции объектов(2 запроса)  и потом собираем из этих коллекций коллекцию ТО (для этого надо из каждого элемента вытянуть по полю и сравнить их). сложность N*N
2) достаем коллекцию из N элементов из базы и при создании ТО  вытягиваем из базы нужные объекты для каждого элемента коллекции(получается N+1 запросов, и сложность N) .
Вопрос в том, что выбрать если эту операцию запрашивает очень много юзеров, не положит ли второй вариант базу?


Grigory Kislin [10 hours ago]
в общем случае обращение к базе гораздо затратнее. возможно при очень больших N из за нелинейности проиграет сортировка. вообще я предлагаю самому все мерять- гораздо полезнее


Ilya [8:16 AM]
Для тех, кто начал - интересно обсудить, кто как понял этот пункт:
Menu changes each day (admins do the updates)
Ведь, интерпритации как минимум две:
- Админ обновляет меню для ресторана каждый день, в день голосования;
- Админ обновляет меню на неделю вперед.
Логичней и проще будет взять первый вариант, но все же интересно услышать мнение других.

Ilya [8:25 AM]
Хотя, пункт “Each restaurant provides new menu each day”  как бы намекает, что только первый вариант возможен.

Aleksey Vra [8:25 AM]
да вроде все однознанчо, - меню меняется каждый день (админ обновляет)

Ilya [8:27 AM]
@Aleksey Vra ну, всм, я могу его поменять на неделю вперед. Т.е. оно будет меняться каждый день, т.к. меню за первый день не будет равно меню за второй день. В общем, я просто для шума тут решил написать, а то молчат все)

Aleksey Vra [8:28 AM]
ну так если написано что меню меняется ежедневно и его меняет админ, значит меню меняется каждый день админом))) помоему все просто, к ДЗ написано же ничего домысливать не надо

Ilya [8:30 AM]
@Aleksey Vra хз, решил убедиться. просто другие пункты вроде однозначно указаны, не придерешься. а тут всетаки можно разные варианты прикинуть. ну да ладно. каждый день - так каждый день.

Aleksey Vra [8:36 AM]
ну я 100% утверждать не стану, просто я так понимаю, чем проще тем лучше)

Ilya [8:37 AM]
чем проще тем лучше - это в точку) у меня уже просто загоны пошли усложнять, надо релакснуть)

Sergey [2:52 PM]
Меня вот больше волнует, что я не в одном из 3-х перечисленных городов (

Андрей [4:10 PM]
Есть перевод на русский? Я не уверен что правильно превожу(и понимаю)...

qf05 [8:54 PM]
Я первый раз сталкиваюсь с подобным тз, и меня смутила подсказка про историю еды и голосований. Т.Е. история это базовая вещь, а является ли базовой вещью возможность админам управлять юзерами, и является ли базовой возможность регистрации новых юзеров?


qf05 [Mar 27th at 9:00 PM]
in #graduation
Кстати я очень долго думал над тем, что лайки у ресторанов должны только накапливаться или каждый день как бы обнуляться. 
Наверное обсуждать эту тему может быть не рекомендовано, так как могут выплыть слишком очевидные подсказки для будущих читателей. Просто не мог не поделиться этим вопросом, уж слишком много нервов он мне вымотал.


1 reply
Grigory Kislin [1 day ago]
я на эту тему намекал в ТЗ


qf05 [Mar 27th at 9:08 PM]
in #graduation
Вот ещё хотел спросить, мы в основном проекте заполняя базу тестовыми данными пишем ручками каждую будущую строчку в базе, а есть ли возможность как то использовать цикл для этого, чтобы поместить в тестовую базу 100 000 000 записей?
что бы получилось типа так:
('2015-05-30 10:00:00', 'Завтрак', 500, 100000),
('2015-05-31 10:00:01', 'Завтрак1', 501, 100000),
....
('2017-01-22 14:23:11', 'Завтрак67028', 67529, 100000),


1 reply
Grigory Kislin [1 day ago]
с помощью java делается либо postgres процедурой-она есть в 4м уроке, где на индексы смотрим


Tanya [9:18 PM]
если рандомно, то есть сайты-генераторы типа http://www.generatedata.com/#generator
generatedata.com
generatedata.com
GenerateData.com: free, GNU-licensed, random custom data generator for testing software


Jan [Yesterday at 11:38 PM]
in #graduation
Я могу использовать start.spring.io  для генерации склета выпускного проекта или есть какие-то ограничения ?


3 replies
Grigory Kislin [14 minutes ago]
если в ТЗ нет ограничений- то все можно


realcorwin [14 minutes ago]
в общем, пиши на php :laughing:



Jan [11 minutes ago]
А при чем тут пхп ?


realcorwin [3 days ago]
@Jan, это шутка была :slightly_smiling_face:


Ilya [Today at 5:23 AM]
in #graduation
Я продолжаю свою паранойю по поводу формата исполнения задания. 
Стал интересен следующий пункт:
13: Историю еды и голосований лучше сделать. Нужно различать базовые вещи, которые закладываются в архитектуру приложения и неочевидные доработки к ТЗ, которых лучше не делать.

Как по вашему, стоит ли делать историю происходящего  на сервисе внутри БД или же грузить на жесткий диск железа, где ,якобы , будет развернуто приложение ? А то тут совершенно разные структуры БД вырисовываются при разных подходах.


9 replies
Grigory Kislin [13 hours ago]
правильно я понял вопрос- база в памяти или в файле? можно и так и так, наверно даже в памяти лучше


Ilya [13 hours ago]
@Grigory Kislin ну я о том, что у нас есть лог событий за неделю - как проходили голосования, какая былая еда и т.д - нам это же не нужно копить в БД ? Можно сделать, чтобы после каждого обновления меню предыдущие данные сливались в какой-нибудь текстовый файлик и из БД данные удалялись.


qf05 [12 hours ago]
А я так понял, что история должна иметь возможность быть доступной на стороне web.


Ilya [12 hours ago]
так, вот поэтому я и спрашиваю) значит нужно перепиливать все. хныг :confused:


qf05 [12 hours ago]
не факт, может я не прав)


qf05 [12 hours ago]
думаю, тут настолько не строгие рамки, что у каждого получится что то своё, со своей функциональностью.

Ilya [12 hours ago]
ну, просто причина всех мои глупых/парнойных вопросов в том, что на проверку бы хотелось уже отдать проект более-менее зрелый, т.к. ревьюится один раз. поэтому хочется уточнить все. в целом, не так сложно дополнить будет, что реализовать историю. тут вот конкретные вопросы с тем, как правильно объекты передать на фронт при запросе на отображение. щас сформулирую попозже.


qf05 [11 hours ago]
нормальные вопросы... у меня и поглупее есть)))


Grigory Kislin [4 hours ago]
в лог неудобно запросы делать:) а в базу- удобно. те если пишется приложение голосования, то 99,9% будет с историей. которая не в логах а в базе (edited)


Ilya [12:57 PM]
Еще есть вопрос: рассматриваем ситуацию, когда юзер делает GET страницы с данными - т.е.  мы должны получить всю информацию о ресторане и текущем меню в рамках одного запроса к БД и передать на фронт. 
У нас, допустим, есть две таблицы: Рестораны и Меню.
Я запилил класс, где отношение @ManyToOne (много записей меню к одному ресторану) - и через fetch забираю сразу запись меню и объект ресторана для этой записи. Все бы ничего, но появились сомнения, т.к. получается, что в памяти будут объекты, повторяющие одну и туже информацию. 
Выглядит это так:
MenuEntries{restaurant:Restaurant_1,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_1_Dish_1’, price=100}
MenuEntries{restaurant:Restaurant_1,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_1_Dish_2’, price=200}
MenuEntries{restaurant:Restaurant_1,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_1_Dish_3’, price=300}
MenuEntries{restaurant:Restaurant_2,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_2_Dish_1’, price=100}
MenuEntries{restaurant:Restaurant_2,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_2_Dish_2’, price=200}
MenuEntries{restaurant:Restaurant_2,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_2_Dish_3’, price=300}
MenuEntries{restaurant:Restaurant_3,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_3_Dish_1’, price=100}
MenuEntries{restaurant:Restaurant_3,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_3_Dish_2’, price=200}
MenuEntries{restaurant:Restaurant_3,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_3_Dish_3’, price=300}
С одной стороны, объект ресторана легковесный и там почти ничего нет, с другой не очень круто иметь такую избыточность. 
Перебивать такую структуру в какой-то TO - накладно. 
А отдавать на фронт в виде листа таких объектов - не круто. т.к. фронтовику придется выпиливать  нужные данные.
У кого-нибудь есть мысли, чтобы одним селектом получить объект, где есть вся инфа в удобном виде ?

eageev [3:18 PM]
Начал делать выпускной проект. 1й вопрос - Зачем нам NotFoundException, когда есть javax.persistence.EntityNotFoundException?

eageev [9:42 PM]
uploaded this image: voting.jpg 


eageev [9:46 PM]
Офигеть! Чтобы это увидеть пришлось биться со Спрингом полдня. (С Boot наверн было бы быстрее). web.xml лучше не писать - выпадает ошибка, xml-конфигов не нашел, заюзал конфиги на аннотациях. С разными эксепшнами пришлось бороться..

Viktor [10:10 PM]
а в чем проблема с web.xml? Там же вроде только фильтр по желанию на кодировку и передача запросов диспетчеру спринга.


qf05 [Today at 11:15 PM]
in #graduation
а как в @NamedQuery можно сравнить даты, а именно LocalDate с LocalDatе, что бы выбрать записи с одинаковыми датами?
WHERE  r.date=:date    - не работает.


1 reply
dmitry_ov [3 minutes ago]
Думаю надо в сторону timestamp смотреть. Это тип значения в ячейке БД. Привести LocalDate к этому типу и тогда сравнение заработает


Viktor [6 days ago]
не работать может по разному, конкретнее формулируй проблему.


Viktor [6 days ago]
@dmitry_ov NamedQuery вроде использует JPQL чтобы абстрагировать от БД, думаю привязываться к ней через timestamp идея не очень


qf05 [5 days ago]
ну тут поразобравшись я выяснил что если из базы достается дата с временем большим чем 0, то и возникает эта ошибка. Как сравнить эти даты без учета времени?


Viktor [5 days ago]
достать дату и время, перевести в дату, сравнить 2 даты.


qf05 [5 days ago]
а как перевести дату и время в дату внутри NamedQuery


Viktor [5 days ago]
никак, это запрос а не операция.
Даже если как-то можно, это очень плохо смешивать логику и запрос.


Viktor [5 days ago]
Я не совсем понял, у тебя в базе у сущности DateTime а в entity просто Date?


qf05 [5 days ago]
нет у меня две LocalDate, но почему то в базу заносится дата и время, а мне для логики нужны только даты.


Viktor [5 days ago]
а в скрипте создания таблицы что создаешь? (edited)


qf05 [5 days ago]
в таблице как раз TIMESTAMP стоял, сейчас подумал, и переписал ту часть где время вообще использовалось, и в базе поставил тип DATE (ну я дебил, как сразу до этого не догадался). 
Но интересный вопрос остался, если бы я использовал LocalDateTime и по логике мне где то нужно было бы время, то как решить задачу с проверкой даты? Самое лучшее что я придумал это передавать в Qwery два параметра, первый date.atStartOfDay(), второй параметр это первый+1день и делать в запросе between.


qf05 [5 days ago]
Виктор, спасибо большое, что то я на такой фигне лютого тупника словил.


Andrey [3:09 PM]
Всем привет! Я думаю, что таблицу Меню делать не надо, так как неизвестно сколько будет блюд

ivanpobeguts [3:10 PM]
Привет, у меня такой вопрос: в задании написано, что стэк технологий: spring, hibernate. Мне интересно, можно ли использовать spring data Jpa)

Andrey [3:11 PM]
Spring Data рекомандовано и проще

Aleksei Kirillov [3:16 PM]
Мне кажется, что меню нужно, так как клиент голосует за меню

Andrey [3:23 PM]
Класс то Меню нужен - я не спорю, а вот нужна ли таблица? Или жестко прописать ,что в таблице 5 столбцов (Если мы хотим, чтобы таблица отображала несколько меню). Если предположить, что в таблице Меню отображает одно меню, то можно просто лист сделать из блюд
Ну и еще туда записать ид админа, который это меню сделал ну и еще чего нибудь

Aleksei Kirillov [3:57 PM]
Как написали "лишнего не придумывать", то у меня в таблице меню три поля :id, id ресторана, дата

Andrey [4:16 PM]
В данном случае тогда как сделать принадлежность блюда к какому-то меню? Еще одну таблицу делать id блюда, id меню?

Aleksei Kirillov [4:28 PM]
Да, плюс наименование и цена

Andrey [4:38 PM]
Вот я думаю как клиент будет создавать меню на фронт-енде? Будет кнопка выбрать блюдо и сохранить в меню и создать меню например.... Т.е. только после нажатия кнопки создать меню я записываю в таблицу (id блюда, id меню). А при нажатии "выбрать блюдо и сохранить в меню" отрабатывает фронт-енд и создается некий список. Но можно ли передать с клиента как объект список типа id блюда или это как говорится проблема фронт-енд разработчика?

Aleksei Kirillov [4:54 PM]
В постановке написано, сделать сначала основное, а потом можно накручивать функционал. Значит сначала надо просто сделать добавление нового блюда в меню. А потом уже и копирование из существующего меню добавить.

eageev [4:57 PM]
Я бы сделал общую таблицу products (или как хотите, dishes напр..) со всеми существующими блюдами, а меню уже делал как линковочную. И рестораны конечно.
хотя возможны и другие варианты - не создавать линковочную, а записывать меню в мапу или лист, сериализовать и записывать сериализованную строку в таб ресторанов для нужного ресторана.

qf05 [1:51 PM]
Всем привет, столкнулся тут с такой проблемой: в базе использую тип DATE для хранения даты, в коде использую LocalDate. И вроде всё работает, но если передать в запрос LocalDate.MAX или MIN то вылетает 
HsqlException: data exception: datetime field overflow
Подскажите, как это обойти? 
Пробовал @Column(columnDefinition = "blob") - не работает.

Pavel Zaitcev [2:00 PM]
Григорий в DateTimeUtil использует:

```public static final LocalDate MIN_DATE = LocalDate.of(1, 1, 1);
public static final LocalDate MAX_DATE = LocalDate.of(3000, 1, 1);```
Сделай аналогично.


qf05 [Yesterday at 2:04 PM]
in #graduation
Спасибо! А эти константы же можно будет потом на фронте юзать?


2 replies
Pavel Zaitcev [24 hours ago]
Чисто технически, можно. Чисто практически, к чему это? Делай по принципу: если временные параметры в запросе не заданы, значит они равны вот этим границам (MIN/MAX). Потребности прям на фронте в них нет.


qf05 [24 hours ago]
точно, просто до сервлета с контороллером я ещё не добрался, не подумал что там можно их юзать)


qf05 [2:27 PM]
А кто-нибудь придумал как сделать тесты для повторного голосования до и после 11 часов, что бы не зависеть от реального времени. Я долго искал как изменить системное время джавы, но нашел только как время винды поменять, и я думаю - это плохая идея.

Arthur [2:30 PM]
ты не должен привязываться к реальному времени

qf05 [2:41 PM]
Тоесть это нормально будет если я специально для тестов введу в репозиторий лишнюю переменную?

Viktor [9:38 PM]
@qf05 есть другие варианты

Arthur [12:13 AM]
Если включить фантазию, можно создать бин времени. В боевой системе он будет дублировать системное время, в тестовом окружении мы подсовываем бин заглушку, которую можно конфигурить как захочется.

Ilya [7:35 AM]
мне вот интересно - нужно ли отображать в истории голосования голоса, которые были изменены. а то сейчас я пилю merge и замещаю ранее сделанный голос но новый. т.е. старая запись не хранится. да и как-то делать мусорку в базе не хочется храня старые записи. а пилить отдельную таблицу для старых голосов - чото через чур.

Arthur [12:07 PM]
Мне кажется ты путаешь понятия: история голосований и история изменений.

Ilya [12:53 PM]
измененный голос - это тоже голос) так что хз. ну, я пока запилил простой случай без учета предыдущих голосов. т.к. этот функционал плюшка сверху, а не условие.

Arthur [1:26 PM]
измененный голос - сам голос бизнес значение имеет. А вот его предыдущее значение (в рамках текущей формулировки ТЗ ) - нет. 
Согласен?

Ilya [1:35 PM]
изменение мнения - это тоже действие, и возможно кому-то оно интересно. вдруг админ добавил/убрал новое блюдо и люди сменили мнение с А на Б. Было бы интересно учесть это. В общем, это уже все частные случаи. Как я сказал - в реализации я их учитывать не буду. Но логика, тем не менее, в этом есть.
и была бы история голосования в изначальной формулировке, тогда я бы не спрашивал) а так, изначально говорят, делайте самый простой вариант, но вот вам еще дополнительное условие, то хочется уточнений.


Grigory Kislin [1 day ago]
по поводу уточнений- см ТЗ. там я специально написал на эту тему (edited)


eageev [11:34 PM]
Обычно ТЗ и пишутся в такой расплывчатой форме (видимо, чтобы в какой-то части задания разраб проявил фантазию). И в идеале, когда ты просто его делаешь, как видишь, не задавая вопросов. Если собираешься устраиваться на работу, еще с этим столкнешься.

Aleksei Kirillov [8:17 AM]
Привет! У кого какие слои в проекте для работы с базой через DataJpa?
У меня model, repository, service. 
Может что-то лишнее или не хватает? 
Я так думаю, что если в слое repository есть еще crudrepository, то может быть не нужен дополнительно слой service?

Alexander_Gubanow [10:31 AM]
А в каком слое запросы принимать будешь?

Aleksei Kirillov [10:34 AM]
может в контроллере
пытаюсь расшифровать условие "Предпочтительно использовать DATA-JPA (можно без лишней делегации, напрямую из сервиса/контроллера дергать Repository)"
и это "5.3 НЕ надо делать классов репозиториев, если там нет ничего, кроме делегирования."

qf05 [12:06 PM]
Народ подскажите, бьюсь который день, никак не получается сделать mock на LocalTime.now(). Пробовал разные моки, разные способы, то не запускается вообще, то моки не подменяют методы, то сервис не авторивьется.
Может кто знает рабочее решение, покажите пожалуйста.
У меня java9. PowerMock как я понял с девяткой вообще не работает, сейчас мучаю JMockit. (edited)

Alexander_Gubanow [12:12 PM]
@Aleksei Kirillov Например, ты хочешь в контроллере достать список ресторанов. Через Data-Jpa у тебя будет интерфейс public interface CrudRestaurantRepository extends JpaRepository<Restaurant,Integer> . В контроллере можешь сразу дернуть сrudRestaurantRepository.findAll() без лишнего делегирования

Aleksei Kirillov [12:13 PM]
Ну т.е. в таком случае слой сервиса не нужен?

Alexander_Gubanow [12:14 PM]
Если там нет никакой логики то ненужен

qf05 [1:32 PM]
подскажите, как сделать, что бы один из тестов запускался с таким аргументом VM  -Djdk.attach.allowAttachSelf ?

Viktor [5:39 PM]
@qf05 ты похоже себе жизнь усложняешь :smiley: заставить 1 тест лезть в настройки jvm, это уже не unti тест. Попробуй использовать mockito я обычно ей пользуюсь (edited)

qf05 [7:09 PM]
@Viktor пробую, не получается. 
VoicesRepositoryImpl r = mock(VoicesRepositoryImpl.class);
       when(r.now()).thenReturn(LocalTime.of(10,0));
В результате от наличия этого мока ничего не меняется вообще. Что я делаю не так? (edited)
@Viktor и mockito не может подменить LocalTime.now() , по этому приходится выносить запрос времени в отдельный метод, и делать мок на него, но у меня это почему то не выходит(((

Viktor [7:31 PM]
если я не ошибаюсь LocalTime.now() - статический метод, его подменить нельзя, хотя может как-то можно но тут надо искать как заменить статический метод
@qf05 у тебя в репозитории есть метод now? и он возвращает LocalTime.now()?

qf05 [7:37 PM]
@Viktor да, пришлось сделать, но толку всё равно нет, тоже самое если сделать отдельный интерфейс с классом который имеет всего один метод и возвращает реальное время, сделать на него мок ,а в репозитории дергать время через него.
Пробую разные варианты, ничего не получается(

Viktor [7:39 PM]
@qf05 подсказка, не туда смотришь. Репозиторий за какую логику отвечает?

qf05 [7:51 PM]
@Viktor за работу с бд. Но в нем у меня стоит if (если в базе есть сегодняшний голос от этого юзера, то если сейчас больше 11:00 то ретурн null, если меньше то голос меняется). Думал перенести это в сервис... но какая разница... всё равно замокать LocalTime не получается(((  
Через JMokit всё работает если использовать аргумент VM, без него никак т.к. у меня проклятая java 9. Прописал этот аргумент в mavene, работало пока не запустил mavenTest.

Viktor [7:56 PM]
а зачем его мокать в сервисе?
с другой стороны есть ещё контроллер :smiley:

qf05 [8:12 PM]
@Viktor какая разница где проходит сравнение с реальным временем, всё рано его надо как то незаметно для кода подменять.

Viktor [8:35 PM]
зачем сравнивать с реальным временем? получай время как параметр.

Victor Shinkarev [8:56 PM]
Стоит ли подключить Swagger? Или лучше через Postman тестировать?

qf05 [9:24 PM]
@Viktor Походу так и придётся делать(((( С JMockit я всё красиво сделал, и еслиб у меня 8 джава стояла, я и не понял что тут какие то проблемы могут быть. Зато столько нового узнал))))  
Спасибо за помощь.


Dmitry Neustupov [Yesterday at 2:16 PM]
in #graduation
Коллеги, подскажите, почему привязываться к системному времени при проверке на апдейт голоса по времени не верно? Или разговор шёл только о невозможности тестирования данного подхода?


2 replies
Grigory Kislin [1 day ago]
только для тестирования


Dmitry Neustupov [1 day ago]
@Grigory Kislin спасибо!


Grigory Kislin [5:57 PM]
проверяю выпускной прошлого выпуска- самая основная ошибка у огромного большинства:  делают то, что не требуется по ДЗ и там совершают огромное количество непростительных ляпов. особенно относится к голосам
золотое правило- сделайте просто, но зато правильно:) (edited)


pro [6:00 PM]
нужно ли в выпускной добавлять логирование, тесты, и прочие вспомогательные зависимости?

Grigory Kislin [6:47 PM]
логирование- да
тесты- будет лучше с ними
прочие вспомогательные зависимости- ничего лишнего


pro [11:42 AM]
делаю ресторан, который добавил и модерирует один админ, доступным для модерирования остальным админам (edited)


Daniil [Today at 4:54 PM]
in #graduation
Всем добрый день. В readme написано "Тестовое задание на оплачиваемую стажировку". Что означает "оплачиваемая"? Куда пойдет это тестовое задание и что будет, если его примут? Заранее извиняюсь, если где-то что-то пропустил.


4 replies
Grigory Kislin [4 hours ago]
http://javaops.ru/#internship
недавно он еще в состоянии пилотного проекта
еще в ожидании его результатов первой стажировки
Java Online Projects
Онлайн обучение Java/Spring/JPA. Практика, проекты, стажировки
Онлайн обучение Java Web, Spring/JPA, Enterprise. От новичков до эксперта. Совместная разработка проектов. БЕСПЛАТНОЕ вступительное занятие. Стажировки и помощь в трудоустройстве. Получи опыт работы его в реальном Spring/JPA Enterprise проекте (50 kB)


pro [3 hours ago]
вот как.. то есть, работодатель платит за стажировку избранных?


Grigory Kislin [3 hours ago]
да, счас ждем итогов


Daniil [39 minutes ago]
спасибо за ответ


pro [5:59 PM]
ты же платишь за стажировку..
если примут - думаю изменится цвет и надпись табло, которое на основном сайте JR (сейчас - зеленое с надписью "на стажировке", станет красным с надписью "выпускник"). Если эти изменения кажутся тебе незначительными - постарайся из стажировки что-нибудь Извлечь.

Daniil [8:56 PM]
лол, javaops недоступен из-за буйного РКН, приходится заходить через тор

ilya t. [9:05 PM]
ахахахах
а это точно ркн?)
а телега то работает)
правда через прокси, но у знакомых и без нее пока еще

ilya t. [9:12 PM]
да, точно через впн работает, судя по всему он


Grigory Kislin [11:16 PM]
у меня вчера неработал, сегодня отпустило...
https://www.rbc.ru/technology_and_media/16/04/2018/5ad4b5c59a794739885fa03a
РБК
Попал под раздачу: как из-за Telegram в России блокируют адреса Amazon
Роскомнадзор приступил к блокировке мессенджера Telegram в России. Одновременно ведомство заблокировало 1,8 млн IP-адресов облачного сервиса Amazon Web Services, из-за чего недоступными оказались «невиновные» сайты
https://s0.rbk.ru/v6_top_pics/media/img/6/39/755239070062396.jpg

realcorwin [11:23 PM]
collateral damage :slightly_smiling_face:


ilya t. [11:38 PM]
у меня до сих пор с компа не заходит, только через впн


Grigory Kislin [2:17 PM]
потестил https://ping-admin.ru/free_test/
в основном работает, но есть кого еще заблокировали
ping-admin.ru
Бесплатная проверка доступности сайта из различных частей мира: Ping-Admin.Ru — мониторинг сайтов и серверов. Проверка работы сайта
Ping-Admin.Ru осуществляет круглосуточный мониторинг на вашем сервере таких сервисов как: HTTP, HTTPS; FTP; MySQL, PostgreSQL; POP3, SMTP, IMAP; DNS, а также проверки с помощью Ping и Telnet.

ilya t. [3:57 PM]
Эээ видимо и slack заблочили... (edited)
У меня перестал входить с компа
Просто замечательно

Dmitry Neustupov [5:19 PM]
У меня всё хорошо )


Andrey [Today at 12:54 AM]
in #graduation
Ребята, а кто по курсу кто консультации дает? По Rest есть вопросы. Григорий или может еще кто?


1 reply
Grigory Kislin [14 hours ago]
по rest есть 2 хорошие ссылки в graduation задании


pro [1:17 PM]
видать я все таки с упрощенным фронт-эндом сделаю сначала, а затем его уберу: так легче проверить все досконально, иначе как еще выполнить это "..с точки зрения того, кто им будет пользоваться (frontend)"


Grigory Kislin [6 hours ago]
ну, тоже вариант, если api сразу сложно


Dmitry Neustupov [1 hour ago]
я тоже делаю с юай, потом выпилю ненужное.


ivanpobeguts [Today at 12:40 AM]
in #graduation
Всем привет. Не очень понимаю, как сделать авторизацию пользователей. В top java мы заходим на стартовую страничку и там хотя бы можем выбрать пользователя. А без фронта я не очень понимаю, какой механизм должен быть. Подскажите, пожалуйста.


2 replies
Dmitry Neustupov [5 hours ago]
Spring Security?


ivanpobeguts [4 hours ago]
Пока его в topjava не было, ногтя догадывался, что без него никак) Думал, по-простому можно как-то сделать для начала, без него


Grigory Kislin [4 days ago]
ждем 9е занятие


qf05 [11:31 AM]
Помогите плиз, я скопировал в свой проект из топджава классы из web связнные с юзером и админом, поправил немного методы, и скопировал их тесты , подтянул все недостающие зависимости, и теперь эти тесты валятся с ошибкой 
Caused by: java.lang.ClassNotFoundException: org.springframework.hateoas.mvc.UriComponentsContributor
если добавить зависимость:
 <dependency>
           <groupId>org.springframework.hateoas</groupId>
           <artifactId>spring-hateoas</artifactId>
           <version>0.23.0.RELEASE</version>
       </dependency>
то вылезает такая ошибка: Caused by: java.lang.IllegalStateException: @Bean method HateoasAwareSpringDataWebConfiguration.pageableResolver called as bean reference for type [org.springframework.data.web.HateoasPageableHandlerMethodArgumentResolver] but overridden by non-compatible bean instance of type [org.springframework.data.web.PageableHandlerMethodArgumentResolver]. Overriding bean of same name declared in: org.springframework.data.web.config.SpringDataWebConfiguration
не понимаю, почему ему вообще могла понадобиться библиотека hateoas, у нас в проекте без неё всё работает?

Grigory Kislin [21 hours ago]
а кто у тебя этот класс дергает по стактрайсу?


qf05 [20 hours ago]
по страктрейсу у меня начиналось расхождение с топджавой после инициализации spring-mvc.xml и писалось что какие то левые три бина переопреопределяются(у меня таких нет, и первый раз такие вообще вижу), и потом использовался класс спринга делигирования, потом спринг поднимал свой рефлекшен, и потом вызывался этот класс и всё падало.

Оказалось ошибка в том что я в component-scan указал сканировать пакет **.web. Я изменил на **.web.action и **.web.user и всё заработало.

Подскажите почему в топджаве мы ставим сканировать пакет и он сканирует все подпакеты, а в моём приложении это не работает. (edited)

Ilya [Yesterday at 5:34 AM]
in #graduation
Вопрос - раз по заданию нужен REST API и никакого фронта, то в контроллере всегда отдаем чистый объект, без моделей и вью резолвера ?


2 replies
Dmitry Neustupov [1 day ago]
отдаём json



Grigory Kislin [1 day ago]
да


qf05 [8:24 PM]
Ломаю голову над тем как подразумевается реализация будущего вью:
на экране список ресторанов и при нажатии на него выпадает его меню или
на экране список ресторанов уже с меню
в зависимости от этого как лучше сделать: за каждым меню запрос в базу или вложенный стрим, и отдавать ресторан уже с меню.

pro [8:32 PM]
тоже над этим думал; решил сделать несколько вариантов метода в контроллере, которые, в зависимости от надобности, будут возвращать или полный список ресторанов с их меню, или другие варианты, в зависимости от того, какие списки могут понадобиться на фронт-энде в том или ином случае


qf05 [Yesterday at 8:34 PM]
in #graduation
Мне кажется если убрать из трансфер объекта поле меню и ходить за каждым меню в базу будет быстрее... т.к. в базе хранится меню за все дни, и придётся тянуть всю эту кучу которая там наберётся спустя много времени и выбирать из нее нужные по дате.


1 reply
Grigory Kislin [13 hours ago]
не надо тянуть за все дни


pro [Yesterday at 8:37 PM]
in #graduation
можно сразу складывать старые в другую таблицу, а со списком ресторанов держать не лениво связанными только свежие меню


1 reply
Grigory Kislin [13 hours ago]
мне кажится это сильное усложнение модели и логики (edited)


realcorwin [Yesterday at 8:45 PM]
in #graduation
зачем думать про "быстрее", если три с половиной калеки пару раз в день будут обращаться к таблице? :slightly_smiling_face: тут надо думать про "проще" :slightly_smiling_face:


2 replies
Grigory Kislin [13 hours ago]
почитай внимательно ТЗ


realcorwin [1 hour ago]
@Grigory Kislin читал вчера невнимательно, но в самом ТЗ (которое на английском) про много юзеров ничего нет


qf05 [8:50 PM]
в задании написано что это приложение рассчитано на очень очень много пользователей. а вот идея с другой таблицей может и хорошая, но мне что то в ней не нравится...

realcorwin [8:51 PM]
а ресторан вы спросили про очень-очень много пользователей? :slightly_smiling_face: не усложняйте, парни :slightly_smiling_face:


VadimSimonov [Apr 26th at 1:49 PM]
in #graduation
Ребята, может кто шарит хорошо.
прописываю как в 9 занятии загрузку таблицу через ajax
"ajax": {
           "url": ajaxUrl,
           "dataSrc": ""
       },
но запросы до контроллера недолетают, что ещё нужно прописать? (edited)


8 replies
Grigory Kislin [2 days ago]
возьми как в user и скопируй. после можешь тихонько менять. то что ты написал проблему- информации никакой почти.


Dmitry Neustupov [2 days ago]
Попробуй вместо "url": ajaxUrl прописать "sAjaxSource": ajaxUrl


Grigory Kislin [2 days ago]
нет

Dmitry Neustupov [2 days ago]
@Grigory Kislin мне помогало, какое то время такая конструкция работала, потом заработало с "url"


Grigory Kislin [2 days ago]
думаю что Ctrl+F5 помогло бы (edited)


VadimSimonov [2 days ago]
да ctrl+f5 помог

Dmitry Neustupov [2 days ago]
надо видимо больше отдыхать....


VadimSimonov [1 day ago]
:+1:


Grigory Kislin [1 day ago]
а еще- внимательнее читать жирный шрифт в начале уроке


Ilya [7:58 AM]
Вопрос, как правильней будет отдавать на фронт объекты, где в связях есть объекты с ленивой загрузкой и нам нужен только их id ? Например, есть класс MenuEntry у него есть в полях ресторан:
   @ManyToOne(fetch = FetchType.LAZY)
   @JoinColumn(name = “restaurant_id”, nullable = false)
   @NotNull
   @JsonIgnore
   private Restaurant restaurant;

Когда достаю запись меню, то хочу видеть, к какому ресторану она принадлежит.
И в другую сторону - хочу получать JSON, где будет MenuEntry и ID ресторана. 
Пока вижу только один путь - в ручную конвертировать MenuEntry в MenuEntryTO, где все отличие будет заключаться только в том, что в MenuEntryTO вместо Restaurant restaurant будет int restaurantId .
Еще, вероятно, можно колдовать с серилизацией и маппингом в JSON, но как-то смутно все представляется. 
Подскажите, плз, какой путь избрать, чтобы не прогадать. (edited)

Dmitry Neustupov [12 hours ago]
Я поставил EAGER у меню, не знаю, насколько это неправильно, на один запрос в базу больше стало, но работать с меню удобнее.


Grigory Kislin [12 hours ago]
решения 2
1. очевидное- to
2. не совсем тривиально для ORM- хранить fk: https://stackoverflow.com/questions/6311776/hibernate-foreign-keys-instead-of-entities
stackoverflow.com
Hibernate - Foreign keys instead of Entities
Currently, Hibernate allows me to load objects defined by *-to-one relationships directly with entity1.getEntity2() Is it possible to get the foreign key instead of the object? The current appr...
 


Dmitry Neustupov [1 hour ago]
Глянул свой код ещё раз, глупость сморозил, ставил EAGER чтобы вытаскивать название ресторана у меню. (edited)


Dmitry Neustupov [40 minutes ago]
Попутно вопрос задам - а зачем понадобилось в меню id ресторана на ресте отдавать? Интересно ) (edited)


qf05 [Today at 9:38 PM]
in #graduation
Подскажите плз, у меня сама программа работает так, как я и задумывал, вопрос по тестам:
я в тестах делаю сет тестовым ресторанам тестовой еды (в смысле в классах TestData), и тоже самое для голосов. Получается как бы рекурсия, что у ресторана есть еда у которой этот ресторан у которого эта еда и т.д. 
В целом всё написал, всё работает как надо. Но я получаю ошибку StackOverflowError в классах Menu и Voices рестКонтроллерТест. Для её устранения я в beforeClass для этих классов очищаю у тестовых ресторанов списки меню и еды, а в afterClass снова заполняю как было. 
Вопрос: это нормальная практика или надо делать ТО для еды и голосов специально для тестовых классов? Или может есть ещё какие то тайные способы как избавиться от рекурсии во время записи объекта в json?


2 replies
Dmitry Neustupov [2 hours ago]
@JsonIgnoreProperties попробуй


qf05 [2 minutes ago]
не представляю как эту аннотацию можно использовать в тестах, но на всякий случай вставил её везде где только можно - не работает.


Grigory Kislin [1 day ago]
скажи, а приложение у тебя не бросит StackOverflowError, когда им пользоваться начнут?? (edited)


Grigory Kislin [1 day ago]
от рекурсии избавится через аннотации. но еще лучше подумать- нужны ли приложению зависимости тянуть


Grigory Kislin [1 day ago]
и EAGER использовать аккуратно, а не везде (edited)


qf05 [1 day ago]
Нет, само приложение возвращает объекты как надо, и там не может быть StackOverflowError. Эту ошибку вызывают именно те объекты которые я создал в тестах.


qf05 [1 day ago]
В тестах я создаю RES1, RES2... EAT1,EAT2...
при создании просто объектов RES они ничего не знают о еде, а еда при создании сразу знает о том к какому ресторану она относится.
и потом для тестирования я вставляю в объекты RES еду и логично, что получается рекурсия. 
Причём тесты сервиса работают, так как я учёл это, и сделал корректное сравнение. И в РесторанРестКонтроллерТесте тоже всё работает, т.к. там используется ТО.


qf05 [1 day ago]
Но для тестов МенюРестКонтроллера не получается теми же методами, которые мы используем в топДжава сделать ResultMatcher из рекурсивного объекта без ТО. 
По этому либо мне надо просто убирать рекурсию, перед тестами двух классов, либо делать ТО исключительно для тестов, либо сделать ResultMatcher из рекурсивного объекта, но я пока не знаю как.
Какой вариант предпочтительнее? (edited)


Grigory Kislin [11 hours ago]
делай тесты максимально приближено к приложению. в тестах не должно быть объектов, которых не будет в реальном REST


Хэм [Yesterday at 4:18 PM]
in #graduation
Ребят, а кто свой проект пилит на spring boot? как у вас полет без xml конфигураций??? отпишитесь будем вместе разбирать полеты!:sweat_smile: (edited)



1 reply
Ilya [8 hours ago]
ты спрашивай что-нибудь конкретное - в буте большая часть из коробки работает, если правильные стартер паки выбрал. остальная конфига через проперти.


pro [9:14 AM]
ребят, каким образом вы воссоздали вот это "4. учитывайте, что пользователей может быть ооочень много, а админов- мало" в приложении


Dmitry Neustupov [Today at 10:19 AM]
in #graduation
@pro я так понимаю, нужно следить за количеством запросов в базу при каждом телодвижении, от пользователей должно быть как можно меньше, поскольку пользователей может быть много. а админов мало - поэтому и запросы у них можно  сильно не оптимизировать. я так думаю.


1 reply
pro [1 hour ago]
благодарю, стало яснее, а то мне ничего не лезло в голову, довольно абстрактное требование


VadimSimonov [4:48 PM]
Ребята, какие условия должны быть соблюдены чтобы эта функция отработала?
function updateTable() {
      $.get(ajaxUrl, function (data) { datatableApi.clear();
       $.each(data, function (i, item) { datatableApi.rows.add(item); }); datatableApi.draw(false); });
На данный момент по js таблица отрисовывается и по ajax обновляется при нажатии на f5, но когда доходит до этого метода (при редактировании данных) ничего не происходит только таблица очищается и ошибки не валятся. (edited)


Yevhen Maksymovych [Yesterday at 4:52 PM]
in #graduation
ajaxUrl должен вести на соответствующий метод, который возвращает данные (это можешь посмотреть на вкладке нетворк в браузере или брякой)


2 replies
VadimSimonov [20 hours ago]
данные все приходят из контроллера


VadimSimonov [20 hours ago]
в JS dataTable не попадает


Yevhen Maksymovych [4:54 PM]
datatableApi должна указывать на корректную таблицу в jsp
и столбцы в таблице должны соответствовать полям приходящего json

VadimSimonov [5:05 PM]
@Grigory Kislin не тут проблема в другом, всё это соотвествует и при несоотвествие ошибка вылетала бы (edited)


Grigory Kislin [Today at 12:06 AM]
in #graduation
1. в graduation нет UI. почему по js вопросы? если это hw9- то канал не этот
2. правильно ли я понял, что у тебя each не работает? подебажил? data приходит? ошибок в консоли нет? (edited)


1 reply
VadimSimonov [4 hours ago]
1) Я решил потренироваться, это не hw9
2)  each работает, data приходит


VadimSimonov [9:14 AM]
uploaded this image: dataTable.jpg 


VadimSimonov [9:16 AM]
@Grigory Kislin может это из за моей dataTable? Я в гист выложил
https://gist.github.com/VadimSimonov/4d736af1ad5a93c096281b342fe3916d


Grigory Kislin [3 days ago]
я не очень знаком с интерфейсами datatables. попробуй поэкспеременитировать


VadimSimonov [14 hours ago]
Вот так работает
       datatableApi.ajax.reload();


Эрик [10:24 AM]
added and commented on this Java snippet: Untitled 
public interface VoteRepository extends JpaRepository<Vote, Integer> {
  @Override
  @Transactional
  Vote save(Vote vote);
​
//базовый класс
@MappedSuperclass
@Access(AccessType.FIELD)
public abstract class AbstractBaseEntity implements HasId {
  public static final int START_SEQ = 100000;
​
  @Id
  @SequenceGenerator(name = "global_seq", sequenceName = "global_seq", allocationSize = 1)
  @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "global_seq")
  protected Integer id;
Collapse 
метод save при обновлении сущности с существующим id создает новую сущность с инкрементируемым из базы global sequence. 
где искать проблему?

Ilya [11:49 AM]
Так, кажется я наступил на грабли, которые сам себе поставил. Вопрос по поводу дубликатов и декартового произведения при запросах в базу - у меня есть сущность Restaurant, у нее есть отношение OneToMany с двумя другими сущностями - Vote (голос) и MenuEntry (запись в меню). Когда отдаю в внешний мир RestaurantTO,  то мне необходимо вытащить из БД Restaurant сразу с двумя джоинами (голоса и записи меню). И в общем, имею в итоге запроса здоровый ResultSet, который растет при каждом новом голосе. Т.е. если за один ресторан проголосует один миллион человек и у меня будет три позиции в меню, то в резалт сет будет три миллионы записей меню.
В целом, все работает за счет того, что использую не List, а Set + EntityGraph. Т.е.  повторы записей игнорируются, но всеравно, есть сомнения, что это эффективно, т.к. куча лишних данных. 
И как вообще грамотно отработать такой случай, когда две коллекции и одна из них может быть ооочень большой и нужно доставать сразу две на каждый запрос юзера ? 
В нашем проекте с едой - похожий случай с Юзером, ролями, и едой. Но роли достаются, я так понимаю, не на каждый запрос юзера. В общем, я в ступоре) (edited)


Дима Жуков [7 hours ago]
Наткнулся на такую же хрень))) оказалось когда list и onetomany нельзя использовать несколько join fetch. Пробовал и entitygraph все равно ошибка. Пришлось set использовать и в репозитории из за дубликатов... та же фигня. Но в интернете вроде все сет используют и норм. (edited)


qf05 [2:38 PM]
А у меня какая то байда с аутентификацией, вроде всё сделал как в топ джава. Добавил фильтр в web.xml, добавил файл spring-security.xml, вроде бы всё что нужно добавил в pom, в spring-app добавил <import resource="spring-security.xml"/>. Но у меня авторизация в тестах просто игнорируется. Что я забыл?
Всё разобрался, в абстакт котроллере в  mockMvc забыл добавить секьюрность. (edited)


VadimSimonov [Today at 3:35 PM]
in #graduation
Ребята, кто понял по поводу голосования? Если пользователь проголосовал до 11 и потом заного голосует то он передумал. А если первоначально он проголовал в 14 ч, сколько ему дать времени чтобы он мог передумать?


4 replies
qf05 [8 hours ago]
нисколько.



qf05 [8 hours ago]
как я понял, это типа голосование за рестораны с ланчами, и голосование - это где я собираюсь поесть. а если ты уже поел или ланч закончился, то извиняй поздняк метаться. Только в этой логике я не понимаю зачем вообще голосовать после 11. 
Короче что от нас хотят непонятно, надо делать по тз, а в тз ничего не сказано про период для передумывания после 11 часов, значит его делать не надо.


VadimSimonov [8 hours ago]
значит и проголосовать после 11 нельзя?


dustnfox [6 hours ago]
Я бы сказал, что нет. Следуя житейской логике, ланч начинается в 11. То есть голосование после 11-ти не имеет практического смысла (на кой черт голосовать за уже съеденный по факту ланч?). Более того, если есть история голосований, то оно вредно. После 11 могут наголосовать те, кто не голосовал и в истории останется не то место, куда ходили. Так что, я бы сказал, что после 11 голоса вообще учитывать не стоит. Хоть первые, хоть вторые. Правда, по формулировке задания, я бы сказал, что имелось в виду, что не принимается именно второй голос.

pro [1 day ago]
голосовать можно 0-24, переголосовать только 0-23, я так понял


qf05 [May 8th at 3:27 PM]
in #graduation
Всем привет, подскажите, в тестах можно как то узнать максимальный id в базе?


10 replies
Dmitry Neustupov [1 day ago]
А какая разница в тестах или не в тестах? Запрос в базу на максимальный айди.


Grigory Kislin [1 day ago]
max(id)
но лучше както без этого. sequence как раз для того, чтобы этого не далать (edited)


qf05 [1 day ago]
обошелся без этого, просто поставил аннотацию на обновление базы в рест тестах. Надеюсь это не плохое решение?


qf05 [1 day ago]
@Grigory Kislin а можно поподробней? Я не очень понял что вы имели ввиду. Хоть для приложения это уже не надо, но мне очень интересно.


Grigory Kislin [1 day ago]
поподробнее про что?? яж не заню зачем тебе max(id)


qf05 [1 day ago]
@Grigory Kislin у нас в тестах нет прямых запросов в базу, только через сервис, т.е. для обращения к базе надо либо создавать метод в сервисах который вернёт мах id, или как то можно напрямую обратиться к базе? или можно как то получить значение прямо из SEQUENCE?


Grigory Kislin [24 hours ago]
> для обращения к базе надо либо создавать метод в сервисах который вернёт мах id
зачем??


qf05 [21 hours ago]
@Grigory Kislin ну это то что пришло в голову... ну не понимаю я как достать мах id не написав простыню кода.


Grigory Kislin [10 hours ago]
я до сих пор не понял, зачем тебе max (id)


qf05 [3 hours ago]
@Grigory Kislin я сделал, на мой взгляд логичную, дополнительную функцию копирование меню. И в тестах была ошибка у теста этого метода, когда запускаешь все тесты id становился на 1 больше чем когда запускаешь этот метод отдельно. Кажется это зависит от порядка тестов. По этому я хотел узнать max id, чтобы создавать тестовые объекты с правильным id для любых случаев. Я исправил это добавив в AbstractRest... аннотацию обновления базы из файла populateDB.sql, как у нас сделано в сервисах в топджава. Но столкнувшись с этой проблемой мне всё таки хочется докапаться до решения, мало ли когда пригодится в будущем. Возможно ли достать из sequence  max или next значение и как это сделать? (edited)


Alexander_Gubanow [Yesterday at 3:45 PM]
in #graduation
Юзер может смотреть меню только на сегодня? или назавтра тоже? Я к чему: надо ли реализовывать функциональность выбора будущей даты (завтра, послезавтра) и голосования на нее. Или мы смотрим только меню на сегодня и голосуем до обеда? Кто как реализовал?


5 replies
qf05 [18 hours ago]
я сделал так, что юзер может смотреть меню за любую выбранную им дату, если юзер дату не выбрал, то ему показывается меню на сегодня.


Alexander_Gubanow [17 hours ago]
@qf05 Я понял, спасибо. А если меню на сегодня админ еще не обновил, а юзер уже хочет его посмотреть (например, юзер зашел на сайт в 00ч-01мин), что он увидит? Последнее меню по дате или сообщение, что меню на сегодня нету пока?


Dmitry Neustupov [17 hours ago]
@Alexander_Gubanow у меня видит пустое меню.


Alexander_Gubanow [17 hours ago]
@Dmitry Neustupov А ты делал фронтенд или сразу rest пишешь?


Dmitry Neustupov [16 hours ago]
@Alexander_Gubanow и рест и фронт )


Ilya [3:50 AM]
@Alexander_Gubanow Я кажется это уже спрашивал выше - в условии сказано - “Menu changes each day (admin do the updates). Отсюда, вроде, порешали, что в наличии есть меню только на сегодня. Но видать всетаки каждый сделал по своему)

Dmitry Neustupov [9:00 AM]
@Ilya Меню меняются каждый день(Админ делает обновление) - тут каждый думает по своему, кто как понимает. У меня реализовано так - пользователь видит только на сегодняшний день, и админ делает меню на текущий день. Можно, в принципе, прикрутить и возможность создавать\смотреть на любой день, но в условии об этом явно не написано.

Alexander_Gubanow [9:41 AM]
@Ilya @Dmitry Neustupov Просто я думал так: если наше приложение -для голосования именно на сегодня и юзер решил поесть именно сегодня, то когда он заходит на restaurans - то увидит только те рестораны, которые предлагают на сегодня меню. Зачем ему видеть то, что не актуально на сегодня.

Ilya [9:47 AM]
@Dmitry Neustupov да, согласен.  @Alexander_Gubanow да, у меня так же - если есть еда, помеченная сегоднешним днем, то показываю эти рестораны.

Andrey [1:57 PM]
VadimSimonov [3:35 PM]
Веселое условие: "Ребята, кто понял по поводу голосования? Если пользователь проголосовал до 11 и потом заного голосует то он передумал." Недоработано условие заданий раз каждый понимает по своему. А что значит передумал? Т.е. он проголосовал за другой ресторан и значит счетчик у этого другого увеличиваем на один, а у которого голосовал ранее уменьшаем? Или может у пользователя две кнопки "за " и "против и нажав кнопку "против" он как бы передумывает. Вот и понимай как знаешь

Andrey [2:03 PM]
В общем как я понял мы тут фактически друг другу вопросы задаем, а так как ответы никто не знает, варимся в своей каше и толку нету. Григорий иногда помогает. Хоть бы условие задачи стажировки нормально прописали бы - вопросов бы наполовину стало бы меньше

goodhoopoe [2:19 PM]
ну вообще надо просто внимательно вчитываться
там же черным на басурманском языке написано
"Only one vote counted per user"
что, учитывая следующее условие про "до 11 часов", превращается, если юзер проголосовал повторно до 11, то старый голос стираем, новый записываем

Dmitry Neustupov [2:49 PM]
@Andrey делай так, как понимаешь, в этом вся прелесть )

goodhoopoe [2:59 PM]
ну как понимаешь тоже неправильно. есть моменты, которые не оговорены и нужно их решать по своему мнению, однако в данной ситуации все однозначно же

Dmitry Neustupov [3:06 PM]
@goodhoopoe в данном случае, конечно, всё понятно, но если попадаются неоднозначные пожелания в тз, тут уж сам соискатель, как я думаю, должен верное направление нащупать, если обратной связи у него нет.

goodhoopoe [3:07 PM]
@Dmitry Neustupov да, с этим я согласен. вообще надо уметь брать инициативу на себя и думать сразу и за разработчика и за пользователя системы

realcorwin [3:41 PM]
Всегда надо уточнять и спрашивать

Dmitry Neustupov [4:07 PM]
@realcorwin разговор идёт о случае, когда не у кого спрашивать.

realcorwin [4:11 PM]
это понятно. но в рабочей практике, если некого спрашивать, что-то настолько пошло не так, что нужно срочно подключать начальство и разруливать ситуацию


qf05 [Yesterday at 9:43 PM]
in #graduation
А надо ли в этом задании тоже делать обработку ошибок? Или пусть наружу по стандарту выходят?


1 reply
Grigory Kislin [12 hours ago]
ну.. как сделаешь.. слищком сложно не надо
чтото простое и красивое будет  плюсом


qf05 [Yesterday at 9:17 PM]
in #graduation
ломаю голову, над тем как сделать регистрацию нового юзера.  Вижу два варианта:
1. надо определить заранее название jsp страниц на которые делать редирект (по моему вообще бредово для этого задания).
2. либо в  RestController ловить /.../registration и принимать уже готового юзера, только учесть чтоб секьюрити не ругался.
Может у кого есть более лучшие идеи?


1 reply
Grigory Kislin [10 hours ago]
1. регистрации не требуется в ДЗ
2. тем более не надо jsp


Dmitry Neustupov [9:24 PM]
@qf05 у меня на /rest/admin/users постом прилетает новый юзер в джейсоне, всё по аналогии с топ джавой можно сделать, если есть юай, то там форма регистрации.

qf05 [9:27 PM]
@Dmitry Neustupov а у тебя /rest/admin/ не закрыт спрингСекьюрити для левых людей?
Я ещё решил обойтись без UserTo, вот только нормально ли будет в сервисе проверять при сохранении, если у юзера роли=null, то сетим туда роль юзера? 
Или лучше сделать UserTo и сетить роль при преобразовании юзерТо в юзер как в топджаве?

Dmitry Neustupov [9:33 PM]
@qf05 закрыт конечно ) надо подумать над правильным решением )

qf05 [9:35 PM]
ну если так, то просто делаешь отдельный РестКонтроллер с путём который открыт.
Собственно я так и собирался делать, но думал может что то получше можно придумать.

Dmitry Neustupov [9:35 PM]
@qf05 скорее всего так, это первое, что в голову приходит

roma [11:08 AM]
народ, кто уже сделал или близок к завершению... По трудозатратам - выпускной проект на сколько часов кодинга (средневого topjava выпускника)  оцените? (edited)

Ilya [11:10 AM]
легче чем основной проект, т.к. нужно сделать базис. по времени - хз. смотря насколько быстро сообразишь. можно и за 2-3 вечера запилить, можно за 2 недели.

roma [11:27 AM]
скорее всего мой вариант это 2 недели - спасибо Илья.

Grigory Kislin [11:27 AM]
2-3 вечера- это врядли

Ilya [11:30 AM]
ну, я хз, мб тут уникумы сидят) я пилил постепенно с моменты как дали задание, часы не считал.


Grigory Kislin [4:52 PM]
@here
Друзья,  коммерческая стажировка доступна всем, независимо от проверки ДЗ. Жду ваших выпускных
Без проверки ревью не будет, но кратко скажу. Если есть желание- можно доплатить только за ревью: 1500р (edited)

Grigory Kislin [7:07 PM]
Проходить стажировку можно УДАЛЕННО


qf05 [May 18th at 7:25 AM]
in #graduation
А что за коммерческая стажировка? Можно чуть больше подробностей? (edited)


1 reply
Alexander Shnaider [1 day ago]
Вот тут можно прочитать подробнее http://javaops.ru/view/news#internship
Java Online Projects
Новости Java Online Projects
Java онлайн обучение и стажировки. БЕСПЛАТНЫЕ первые занятия. Трудоустройство. Core/Web, Maven/Spring 5/Security/JPA(Hibernate)/REST/AJAX/Botstrap, Enterprise (43 kB)
 

roma [Yesterday at 5:21 PM]
in #graduation
Народ вопрос нужна ли нам в юзерах такая богатая функциональность как в tj... Перед нами ведь даже не стоит задачи, что бы юзер мог зарегаться или админ релактить юзеров... Я ведь могу просто в базу щапопулейтить нужное кол-во юзеров для демонстрации работоспособности требуемого по тз функционала?


1 reply
pro [4 minutes ago]
скорее всего, нужно искать логические обоснования того или иного поведения приложения. Вот зачем нужна программа/сайт, где нельзя зарегистрироваться и использовать функционал? Разве что только для тестирования.. Тут то же получается, что и с историей голосований: прямо в ТЗ не указано, но из всей стратегии приложения это исходит как само собой разумеющееся


SergeyMuratkin [2:58 PM]
Я думаю делать регистрацию пользователей, так это очевидно необходимая вещь для полноценного работы  REST API,всех юзеров ведь не предусмотришь заранее. Почитай ещё рекомендации Георгия                                                    4: учитывайте, что пользователей может быть ооочень много, а админов- мало 13: Историю еды и голосований лучше сделать. Нужно различать базовые вещи, которые закладываются в архитектуру приложения и неочевидные доработки к ТЗ, которых лучше не делать (edited)

Ilya [3:06 PM]
Так регистрация что здесь, что там 1 в 1 ? Копипаста. В чем проблема добавить ?

roma [18 hours ago]
проблемм вообще нет - действительно 1в1 все ), просто Григорий везеде пишит НИЧЕГО ЛИШНЕГО.... Вот я и подумал не лишнее ли это )

realcorwin [3:17 PM]
интересно, кто-то делал в одной таблице и "ресторан" и "еду с ценой"?

qf05 [12:22 AM]
а это вообще возможно? таблица же не может хранить списки.


realcorwin [Today at 12:30 AM]
in #graduation
н-р, id | date | rest | lunch1 | price1 | ... | lunch5 | price5


3 replies
Pavel Zaitcev [10 hours ago]
Гораздо удобнее ведь хранить разные сущности в разных таблицах и связывать их по ключам (2 и 3 нормальные формы таблиц в помощь). Хранить в одной таблице можно так называемые встроенные сущности (компоненты), которые реализуются как Embeddable/Embedded-классы Hibernate, но это уже другая история :slightly_smiling_face: ИМХО


realcorwin [1 hour ago]
удобство зависит от технических возможностей. с точки зрения реальных сущностей, название ресторана является такой же строчкой с сущности "меню на конкретный день", как и остальные строчки. никакой другой смысловой нагрузки "ресторан" сам по себе не несёт


Aleksei Kirillov [31 minutes ago]
3 нормальные формы - это как отче наш. Без них путной базы данных не получиться.


Pavel Zaitcev [22 hours ago]
@realcorwin С данной точки зрения, получается что сущность "ресторан" вообще можно не создавать, если она представляет собой лишь строчку/поле другой сущности. Технически, конечно, можно сделать и так, но теряется гибкость приложения и возможности его расширения: например, если придется сделать отдельных админов для каждого ресторана? или у ресторана появятся дополнительные свойства, кроме имени в дальнейшем.


realcorwin [22 hours ago]
всё это довольно умозрительно: ну зачем ресторанам по отдельному админу? :slightly_smiling_face: какой в этом смысл в контексте приложения для выбора места обеда для сотрудников? что там расширять?.. во-вторых, не нужно писать того, чего писать не нужно. это и в задании сказано, и в жизни так.


Pavel Zaitcev [21 hours ago]
"Нужно сделать все максимально просто, удобно для доработок..". Добавить новое поле в сущность проще, чем выделять новую сущность с нуля :slightly_smiling_face: Богатая доменная модель, всегда лучше бедной. А если у ресторана будет блюд меньше или больше чем 5, другие поля в таблице будут null?


realcorwin [21 hours ago]
да

realcorwin [21 hours ago]
про "богатую модель чего-либо". это как чувак, которому был нужен холодильник, купит крутой автомобиль. потому что в нём же холодильник есть

Pavel Zaitcev [21 hours ago]
Про null поля тоже не есть хорошо, т.к. теоретически может привести к ошибкам. Гораздо безопаснее когда все поля not null на уровне БД. Ну это отдельная тема для дискуссии. А про богатую доменную модель, скажу что так проще работать с данными в приложении. И удобнее. Собственно ORM нам в этом сильно помогает. Ты уже сделал приложение?


realcorwin [21 hours ago]
да, почти готово. я для себя делаю, мне не нужна никакая стажировка. я сделал с доп. таблицей, потому что слишком хорошо всё ложилось на менеджер калорий и проще было просто перенять всё, как уже есть. но я серьёзно рассмотрел и обдумал разные варианты. поэтому и спросил, делал ли кто-то иначе


Vladimir Gorbatenko [Today at 10:07 AM]
in #graduation
Приветы! У меня при первом рассмотрении ТЗ нарисовалось целых 6 таблиц: users, user_roles, dishes, restaurants, daily_menu, voting. Не преувеличил ли я? (edited)


2 replies
Alexander Shnaider [28 minutes ago]
я тоже начинаю делать, у меня такие же таблицы, только нет daily_menu. Не очень понимаю как это будет работать


Alexander Shnaider [25 minutes ago]
я так представлял что в таблице dishes (у меня meals) будут добавляться блюда каждый день


Dmitry Neustupov [Today at 10:23 AM]
in #graduation
@Vladimir Gorbatenko у меня аналогичная схема - всё работает.


1 reply
Vladimir Gorbatenko [43 minutes ago]
понятно, а то мне вдруг показалось что я думаю как маньяк ))


itAvgur [Today at 10:45 AM]
in #graduation
Привет, коллеги!
Возник такой вопрос, подскажите свой вариант.
Решил сделать несколько sequence в базе, для каждой таблицы своя.
Но id у нас наследуется из одного класса, а @GeneratedValue для поля может только с одной последовательностью работать. А надо для одного Entity - одна sequence, для другого - другая.
Есть мысли куда копать? (edited)


1 reply
Vladimir Gorbatenko [1 hour ago]
Как я понимаю, тебе не нужно в базовом классе использовать одну стратегию для всех, а наоборот в каждой сущности указывать свою стратегию генерации, strategy = GenerationType.IDENTITY.


Vladimir Gorbatenko [10:53 AM]
я правильно понял, цену на блюда каждый ресторан ставит свою? (edited)


Dmitry Neustupov [12:32 PM]
@Vladimir Gorbatenko насколько я понял, каждый реализует по разному, у кого то админ добавляет блюда в меню ресторана и прописывает у каждого название и цену, а у кого то выбирает из списка уже готовых блюд с уже установленными названием и ценой.

Dmitry Neustupov [10:43 AM]
@VadimSimonov в tj сделано через  @ElementCollection(fetch = FetchType.EAGER)
так не пробавал?

itAvgur [9:30 AM]
Чего-то я сломался....
Код ниже.
```public class Restaurant

    @OneToMany(mappedBy = "restaurant", fetch = FetchType.EAGER)
    private List<LunchMenu> lunchMenu;


public class LunchMenu

    @ManyToOne
    @JoinColumn(name = "restaurant_id",nullable = false)
    private Restaurant restaurant;

    @OneToMany(fetch = FetchType.EAGER)
    @JoinTable(name = "lunch_dish_refer", joinColumns = 
        @JoinColumn(name = "lunch_id"), 
        inverseJoinColumns = @JoinColumn(name = "dish_id"))
    private List<Dish> dishes;```

Должен получить 1 LunchMenu (на один день), со списком еду в 3 пункта.
На выходе получаю 1*3 = 3 LunchMenu с 3 единицами.
Т.е. он их умножает.
БД проверил, при включении Lazy для dishes - список приходит один, как и следовало.
Прошу, коллеги, помочь с версиями...

Ilya [9:32 AM]
Версия одна - это декартово произведение, косяк(особенность) маппинга хибернейта. Решения - либо юзать сет вместо листа, либо вставлять дистинкт в запрос
Точнее не косяк, а просто у тебя резалст сет (табличка, которая получается при запросе в БД) сама по себе содержит повторяющиеся записи

itAvgur [9:35 AM]
Кхм, т.е. он так запрос в скуль сформировал?

Ilya [9:37 AM]
ну, попробуй сам руками вбить запрос и увидишь табличку, которая получилась
в oneToMany такая тема, в общем. нужно либо избавляться от него, либо смириться)

itAvgur [9:38 AM]
@Ilya Да, Set помог! Спасибо огромнейшее!
Пива в студию! :+1:
Пошел запрос его анализировать. :nerd_face:

Ilya [9:38 AM]
@itAvgur :+1:

roma [12:26 PM]
Народ вот написано в ТЗ - не нужен FrontEnd, но в тоже время по REST мы должны пулять JSON туда сюда - соответственно все равно нужно подключать datables и JQuery, что бы этот JSON преобразовывать во что то читабельное????

goodhoopoe [12:31 PM]
зачем тебе jq? сервер должен отдавать json и всё. стандартный REST сервис
roma
Народ вот написано в ТЗ - не нужен FrontEnd, но в тоже время по REST мы должны пулять JSON туда сюда - соответственно все равно нужно подключать datables и JQuery, что бы этот JSON преобразовывать во что то читабельное????
Posted in #graduationToday at 12:26 PM

SergeyMuratkin [12:43 PM]
Всё верно, а  JSON он читаемый формат, к тому же можно получать через командную строку curl -s http://localhost:8080/saloon

realcorwin [1:00 PM]
хреначишь аннотацию @RestController - вот тебе и JSON :slightly_smiling_face:

roma [1:48 PM]
погодите - что не надо вообще никакого интерфейчас делать что ли? Просто отдаю наружу JSON и все? (edited)

realcorwin [1:53 PM]
отдаёшь, правишь, удаляешь... обычный REST интерфейс, короче. отправляешь команды - смотришь, что происходит с JSON. всё

roma [1:54 PM]
понял - спасибо


roma [6:08 PM]
Еще вопрос: про то, что админ может редактировать рестораны и меню - на слое web проверять юзера на то какие у него есть роли и если нет админской не давать ему доустум к методам слоя сервисов менябщим БД? Ну тоесть предполагается, что юзер когда авторизовался он оставил след в классе AuthorizedUser? (edited)

roma [8:28 PM]
Остался тут кто живой?

Dmitry Neustupov [8:42 PM]
@roma йес

roma [8:42 PM]
крутяк
по поводу ролей - получается нам нужно хранить не userId в авторизейтед юзерах а только его роль и если он с ролью USER хочет что то менять - мы ему кидаем каокой нибудь грозный респонс статус? Просто в топ джаве мы роли использовали только для спринг секюрити - а тут то он не подразумивается - а как то надо работать ) (edited)
народ безмолвствует :sob:

Dmitry Neustupov [9:25 PM]
@roma у нас есть разные контроллеры для юзеров и для админа, с разными методами и путями соответственно, доступ регулируется секьюрностью, у нас есть пользователи в базе - извне приходит запрос на определённый контроллер с креденшилами юзера, секьюрити сравнивает их с теми, что лежат в базе и, исходя из этого, либо разрешает выполнить метод, либо отклоняет запрос. я так это понимаю.

roma [9:26 PM]
но как я понимаю - мы вообще не должны подключать секьрность

Dmitry Neustupov [9:27 PM]
почему?

roma [9:27 PM]
goodhoopoe
зачем тебе jq? сервер должен отдавать json и всё. стандартный REST сервис
https://topjava13.slack.com/archives/C9U1BCKT4/p1527154018000007
Posted in #graduationMay 24th
как я понял мы только отдаем джейсон и response статусы - что с ними делать задача уже фронтэнда

Dmitry Neustupov [9:29 PM]
так там человек про фронт пишет, он действительно тут не нужен, а секьюрити нужна для разделения прав доступа к контроллерам и методам.
так а если прилетит запрос на контроллер админа от юзера?
секьюрити не даст его выполнить
а может я уже перемудрил )

roma [9:34 PM]
ну вот я думаю - нафига секьюрностью это все разделять - если можно ограничится ролью юзера - и если он не со своей ролью полез в методы доступные только админу - мы ему по рукам за это просто респонс статусом - нам же вроде ничего не надо в приложении скрывать - какие то таблицы от юзеров - все таблицы доступны как юзерам так и админам - но вот некоторые методы (save, delete, update) - доступны только админу (edited)

Dmitry Neustupov [9:37 PM]
К примеру - если выполнить curl -s -X POST -d '{"name": "New123"}' -H 'Content-Type:application/json;charset=UTF-8' http://localhost:8080/rest/admin/restaurants --user admin@yandex.ru:admin - запрос на добавление нового ресторана, который может выполнить только админ, секьюрити смотрит, есть ли у пользователя с прилетевшими креденшилами роль админа ( <intercept-url pattern="/rest/admin/**" access="hasRole('ROLE_ADMIN')"/> ), если есть - метод выполняется, если нет - кидается ошибка.
смысл велосипед изобретать, если уже можно использовать уже готовый код? )

roma [9:42 PM]
так нет никого велосипеда - ты просто делаешь что то такое:
```public class AuthorizedUser {

    private static Set<Role> roles = new HashSet<>();

    static
    {
        roles.add(ROLE_ADMIN);
        roles.add(ROLE_USER);
    }

    public static void setRoles(Set<Role> roles) {
        AuthorizedUser.roles = roles;
    }```
и потом чем то таким
    ```public static boolean containAdmin(Set<Role> roles)
    {
        return  roles.contains(ROLE_ADMIN);
    }```
на слое веб или сервиса проверяешь можно пользоваться методом или нельзя

roma [10:09 PM]
@goodhoopoe не знаю блин кто из нас прав ((( нужна нам секьюрность или нет (((


Grigory Kislin [12:58 AM]
@roma по ТЗ- авторизация на основе ролей


Alexander Shnaider [2:52 PM]
Я правильно понял пункт `16: Предпочтительно использовать DATA-JPA (можно без лишней делегации, напрямую из сервиса/контроллера дергать Repository).` 
что можно обойтись без слоя service и сделать только repository and web?

roma [3:46 PM]
@Alexander Shnaider я тоже это так понял но слой сервис сделал... (edited)

Nedfrench [9:24 PM]
я без слоя сервис делаю


Grigory Kislin [12:24 AM]
если в сервисе ничего нет- лучше без него


Erick [6:19 PM]
uploaded and commented on this image: allTests.JPG 

при запуске всех тестов одного контроллера update не проходит. 
при запуске только этого теста, все работает замечательно.
ошибка возникает в эмуляции mockMvc.perform
.content(JsonUtil.writeValue(updated)))
теряет объект "Menu" вместе с рестораном. 
как починить, подскажите

Erick [6:19 PM]
uploaded this image: oneTest.JPG 


Grigory Kislin [6:20 PM]
@Erick у тебя там кэширования нет?

ujwegh [8:02 PM]
Подскажите пожалуйста, у меня тесты в junit проходят все разом. А когда запускаю maven-test некоторые тесты не проходят. Начинает твориться непонятная штука. Роли меняются местами. Куда копать?

ujwegh [8:03 PM]
uploaded this image: tests.png 


Grigory Kislin [10:01 PM]
@ujwegh кэширование либо константы свои портишь


Евгений Глушков [Today at 7:31 AM]
in #graduation
@Grigory Kislin добрый день. Не могу взять в толк как в проекте index.jsp стартует из папки WEB-INF/jsp.  Я конечно могу в web.xml добавить <welcom-file>, но в проекте topjava этого нет, а в моем graduate без <welcom-fale> я загрузиться из WEB-INF/jsp не могу. Вроде всё одно и то же. И локализация спринг в index.jsp на отрез не видит значения пропертей  и выдаёт только что-то вроде "???app.head???" если через <fmt:message>, а через <spring:message> выбрасывает исключение, что спринг не видит свойство app.head. Не подскажите куда копать?


1 reply
Grigory Kislin [2 hours ago]
в выпускном нет UI, JSP и локализации (edited)


Евгений Глушков [8:58 AM]
Может кто знает? А то я чувствую что простой какой-то затык.

Евгений Глушков [9:15 AM]
Всё, вопрос отпал:
```@GetMapping("/")
    public String root() {
        return "index";
    }```

Dmitry Neustupov [9:25 AM]
@Евгений Глушков подключать security и делать страницу логина не будешь?

Евгений Глушков [10:09 AM]
@Dmitry Neustupov, буду, но к завтра на ревью не успеваю, еще надо все контроллеры доделать, кроме одного.


ujwegh [2:56 PM]
Коллеги, решил прикрутить sucurity, сделал как в проекте. При обновлении пользователя все хорошо обновляется, однако слетает авторизация. Чтобы снова авторизоваться нужно перед паролем вводить {noop}. Что можно сделать в данном случае?

Dmitry Neustupov [3:06 PM]
@ujwegh может быть дело в пасворд энкодере? он перегоняет на слое сервиса туда-сюда пароль?


saudabaew [Jun 6th at 3:07 PM]
in #graduation
а что значит обновить пользователя?


4 replies
ujwegh [2 days ago]
Внести изменения в пользователя. Поменять имя или ещё что


saudabaew [2 days ago]
есть код н гитхаб?


ujwegh [2 days ago]
Ещё не залил


saudabaew [2 days ago]
попробуй: When you are configuring the ClientDetailsServiceConfigurer, you have to also apply the new password storage format to the client secret.

.secret("{noop}secret")


ujwegh [3:26 PM]
При обновлении пасворд энкодер меняет мой пароль на {bcrypt}... И пишет в базу. По идее при дальнейшем действии пароль должен декодироваться. В итоге после обновления на любые запросы пишет 401 unauthorized. Добавка к паролю {noop} позволяет произвести авторизацию и выполнить запросы. Не понимаю почему так
Я могу заменить delegatingPasswordEncoder на NoopPasswordEncoder чтобы гоняли просто текстовые пароли но это не секьюрно как пишут в документации

Alexander Shnaider [2:26 PM]
Друзья, подскажите. Вот есть метод
```@EntityGraph(attributePaths = {"meals"}, type = EntityGraph.EntityGraphType.LOAD)
    @Query("SELECT r FROM Restaurant r WHERE r.id=?1")
    Restaurant getWithMeals(int id);```
есть ли возможность  задать условия, чтобы не все блюда потягивались, а только определённой даты например. Что-то гуглёж мне не помог


Erick [Yesterday at 11:57 PM]
in #graduation
Как запустить приложение с минимальными усилиями, не устанавливая томкат, не прописывая переменные среды... как и что нужно сконфигурировать, чтобы запускаться из командной строки?
Разбираюсь с spring-boot-starter-web 
https://docs.spring.io/spring-boot/docs/current/reference/html/getting-started-first-application.html#getting-started-first-application-dependencies
подскажите, где/что можно почитать?


1 reply
pro [8 hours ago]
cкачай спринг pet clinic и по аналогии сделай, там все автоматически подтягивается


realcorwin [12:15 AM]
https://javabrains.thinkific.com/courses/springboot-quickstart
Java Brains
Spring Boot Quick Start
Learn how to create full end-to-end Spring applications using Spring Boot.
https://s3.amazonaws.com/thinkific/courses/course_card_image_000/213/4021512179090.original.jpg?1512179090