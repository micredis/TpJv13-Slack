Grigory Kislin [1:09 AM]
joined #graduation along with 19 others.

Jan [12:25 PM]
@Grigory Kislin продублируйте дату сдачи проекта в этом чате, пожалуйста. (edited)

Grigory Kislin [12:28 PM]
Cрок сдачи до 07.06. Участникам masterjava: до 01.11 (edited)

Mikhail Makar [12:53 PM]
@Grigory Kislin до 01.11.2018?)


alexey [2:36 PM]
а на проверку до какого нужно сдать?

Oleksii Leshchenko [4:35 PM]
Cрок сдачи до 07.06. Участникам masterjava: до 01.11.
Выше есть сообщение...


Ilya [5:34 AM]
можно глупый вопрос - в задании жирным выделено  - without frontend. Это условие или пожелание ?

qf05 [10:44 AM]
Думаю это условие.
Кто что знает про curl commands? Поделитесь пожалуйста знаниями или ссылками.
Я правильно понимаю, что мы должны отправлять запросы к приложению через командную строку и получать объекты?

Jan [11:13 AM]
Да все верно, а в чем вопрос ?
Скорее представление объектов например в xml или json

Grigory Kislin [4:59 PM]
@Ilya скорее да... если хочется можешь сделать в отдельной ветке
@qf05> Кто что знает про curl commands
у нас будет впереди все. делайте пока то, что прошли (edited)

qf05 [6:47 PM]
ой, я что то затупил походу, думал надо к 1 апреля уже сдать... и если бы не какие то curl commands, думаю успел бы) 
тоесть если я собираюсь пойти на курс masterjava то срок до 1 ноября? Оо


qf05 [Yesterday at 7:54 PM]
in #graduation
Григорий, подскажите пожалуйста, а что считается наиболее затратной операцией: 
есть массив N элементов
1) 10 сортировок этого массива
2) N обращений в базу со слоя репозитория


9 replies
Viktor [1 day ago]
а база какая? и на чем написан слой репо?


Viktor [1 day ago]
какая сортировка?


qf05 [1 day ago]
пусть будет сортировка Collections.sort, а база, незнаю, пусть  HSQLDB например. Но с учётом что эту операцию запрашивает очень очень много юзеров.


qf05 [1 day ago]
слой репо с использованием hibernate, ну как мы сейчас делаем в основном проекте.


Viktor [23 hours ago]
хз, на самом деле постановка вопроса немного странная. Такую бы на собеседовании спросить, мало кто ответит :smiley:
Это как вопрос: есть N груш что тяжелее перебрать 10 груши или собрать N ананасов. (edited)


Viktor [23 hours ago]
по идее сортировка занимает O(N*logN). Обращение в базу константа, т.е. N обращений в базу O(N)
10 из расчетов выбрасывается как константа. Получается все тоже:
- сортировка O(N*logN)
- обращений в базу O(N)
Т.е. обращения в базу быстрее (edited)


aleksey [21 hours ago]
Ну тогда уж можно задать вопрос что у нас там за запросы и в какой структуре индексы хранятся


qf05 [12 hours ago]
я имею ввиду, что у нас в выпускном проекте, много раз обращают внимание на количество запросов к базе, и хочу понять на сколько критично  нагружать базу.
приведу другой пример :
что лучше 
1) достаём из базы две коллекции объектов(2 запроса)  и потом собираем из этих коллекций коллекцию ТО (для этого надо из каждого элемента вытянуть по полю и сравнить их). сложность N*N
2) достаем коллекцию из N элементов из базы и при создании ТО  вытягиваем из базы нужные объекты для каждого элемента коллекции(получается N+1 запросов, и сложность N) .
Вопрос в том, что выбрать если эту операцию запрашивает очень много юзеров, не положит ли второй вариант базу?


Grigory Kislin [10 hours ago]
в общем случае обращение к базе гораздо затратнее. возможно при очень больших N из за нелинейности проиграет сортировка. вообще я предлагаю самому все мерять- гораздо полезнее


Ilya [8:16 AM]
Для тех, кто начал - интересно обсудить, кто как понял этот пункт:
Menu changes each day (admins do the updates)
Ведь, интерпритации как минимум две:
- Админ обновляет меню для ресторана каждый день, в день голосования;
- Админ обновляет меню на неделю вперед.
Логичней и проще будет взять первый вариант, но все же интересно услышать мнение других.

Ilya [8:25 AM]
Хотя, пункт “Each restaurant provides new menu each day”  как бы намекает, что только первый вариант возможен.

Aleksey Vra [8:25 AM]
да вроде все однознанчо, - меню меняется каждый день (админ обновляет)

Ilya [8:27 AM]
@Aleksey Vra ну, всм, я могу его поменять на неделю вперед. Т.е. оно будет меняться каждый день, т.к. меню за первый день не будет равно меню за второй день. В общем, я просто для шума тут решил написать, а то молчат все)

Aleksey Vra [8:28 AM]
ну так если написано что меню меняется ежедневно и его меняет админ, значит меню меняется каждый день админом))) помоему все просто, к ДЗ написано же ничего домысливать не надо

Ilya [8:30 AM]
@Aleksey Vra хз, решил убедиться. просто другие пункты вроде однозначно указаны, не придерешься. а тут всетаки можно разные варианты прикинуть. ну да ладно. каждый день - так каждый день.

Aleksey Vra [8:36 AM]
ну я 100% утверждать не стану, просто я так понимаю, чем проще тем лучше)

Ilya [8:37 AM]
чем проще тем лучше - это в точку) у меня уже просто загоны пошли усложнять, надо релакснуть)

Sergey [2:52 PM]
Меня вот больше волнует, что я не в одном из 3-х перечисленных городов (

Андрей [4:10 PM]
Есть перевод на русский? Я не уверен что правильно превожу(и понимаю)...

qf05 [8:54 PM]
Я первый раз сталкиваюсь с подобным тз, и меня смутила подсказка про историю еды и голосований. Т.Е. история это базовая вещь, а является ли базовой вещью возможность админам управлять юзерами, и является ли базовой возможность регистрации новых юзеров?


qf05 [Mar 27th at 9:00 PM]
in #graduation
Кстати я очень долго думал над тем, что лайки у ресторанов должны только накапливаться или каждый день как бы обнуляться. 
Наверное обсуждать эту тему может быть не рекомендовано, так как могут выплыть слишком очевидные подсказки для будущих читателей. Просто не мог не поделиться этим вопросом, уж слишком много нервов он мне вымотал.


1 reply
Grigory Kislin [1 day ago]
я на эту тему намекал в ТЗ


qf05 [Mar 27th at 9:08 PM]
in #graduation
Вот ещё хотел спросить, мы в основном проекте заполняя базу тестовыми данными пишем ручками каждую будущую строчку в базе, а есть ли возможность как то использовать цикл для этого, чтобы поместить в тестовую базу 100 000 000 записей?
что бы получилось типа так:
('2015-05-30 10:00:00', 'Завтрак', 500, 100000),
('2015-05-31 10:00:01', 'Завтрак1', 501, 100000),
....
('2017-01-22 14:23:11', 'Завтрак67028', 67529, 100000),


1 reply
Grigory Kislin [1 day ago]
с помощью java делается либо postgres процедурой-она есть в 4м уроке, где на индексы смотрим


Tanya [9:18 PM]
если рандомно, то есть сайты-генераторы типа http://www.generatedata.com/#generator
generatedata.com
generatedata.com
GenerateData.com: free, GNU-licensed, random custom data generator for testing software


Jan [Yesterday at 11:38 PM]
in #graduation
Я могу использовать start.spring.io  для генерации склета выпускного проекта или есть какие-то ограничения ?


3 replies
Grigory Kislin [14 minutes ago]
если в ТЗ нет ограничений- то все можно


realcorwin [14 minutes ago]
в общем, пиши на php :laughing:



Jan [11 minutes ago]
А при чем тут пхп ?


realcorwin [3 days ago]
@Jan, это шутка была :slightly_smiling_face:


Ilya [Today at 5:23 AM]
in #graduation
Я продолжаю свою паранойю по поводу формата исполнения задания. 
Стал интересен следующий пункт:
13: Историю еды и голосований лучше сделать. Нужно различать базовые вещи, которые закладываются в архитектуру приложения и неочевидные доработки к ТЗ, которых лучше не делать.

Как по вашему, стоит ли делать историю происходящего  на сервисе внутри БД или же грузить на жесткий диск железа, где ,якобы , будет развернуто приложение ? А то тут совершенно разные структуры БД вырисовываются при разных подходах.


9 replies
Grigory Kislin [13 hours ago]
правильно я понял вопрос- база в памяти или в файле? можно и так и так, наверно даже в памяти лучше


Ilya [13 hours ago]
@Grigory Kislin ну я о том, что у нас есть лог событий за неделю - как проходили голосования, какая былая еда и т.д - нам это же не нужно копить в БД ? Можно сделать, чтобы после каждого обновления меню предыдущие данные сливались в какой-нибудь текстовый файлик и из БД данные удалялись.


qf05 [12 hours ago]
А я так понял, что история должна иметь возможность быть доступной на стороне web.


Ilya [12 hours ago]
так, вот поэтому я и спрашиваю) значит нужно перепиливать все. хныг :confused:


qf05 [12 hours ago]
не факт, может я не прав)


qf05 [12 hours ago]
думаю, тут настолько не строгие рамки, что у каждого получится что то своё, со своей функциональностью.

Ilya [12 hours ago]
ну, просто причина всех мои глупых/парнойных вопросов в том, что на проверку бы хотелось уже отдать проект более-менее зрелый, т.к. ревьюится один раз. поэтому хочется уточнить все. в целом, не так сложно дополнить будет, что реализовать историю. тут вот конкретные вопросы с тем, как правильно объекты передать на фронт при запросе на отображение. щас сформулирую попозже.


qf05 [11 hours ago]
нормальные вопросы... у меня и поглупее есть)))


Grigory Kislin [4 hours ago]
в лог неудобно запросы делать:) а в базу- удобно. те если пишется приложение голосования, то 99,9% будет с историей. которая не в логах а в базе (edited)


Ilya [12:57 PM]
Еще есть вопрос: рассматриваем ситуацию, когда юзер делает GET страницы с данными - т.е.  мы должны получить всю информацию о ресторане и текущем меню в рамках одного запроса к БД и передать на фронт. 
У нас, допустим, есть две таблицы: Рестораны и Меню.
Я запилил класс, где отношение @ManyToOne (много записей меню к одному ресторану) - и через fetch забираю сразу запись меню и объект ресторана для этой записи. Все бы ничего, но появились сомнения, т.к. получается, что в памяти будут объекты, повторяющие одну и туже информацию. 
Выглядит это так:
MenuEntries{restaurant:Restaurant_1,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_1_Dish_1’, price=100}
MenuEntries{restaurant:Restaurant_1,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_1_Dish_2’, price=200}
MenuEntries{restaurant:Restaurant_1,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_1_Dish_3’, price=300}
MenuEntries{restaurant:Restaurant_2,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_2_Dish_1’, price=100}
MenuEntries{restaurant:Restaurant_2,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_2_Dish_2’, price=200}
MenuEntries{restaurant:Restaurant_2,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_2_Dish_3’, price=300}
MenuEntries{restaurant:Restaurant_3,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_3_Dish_1’, price=100}
MenuEntries{restaurant:Restaurant_3,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_3_Dish_2’, price=200}
MenuEntries{restaurant:Restaurant_3,votes=1,lastMenuUpdate=2018-01-01T09:00}, description=‘Rest_3_Dish_3’, price=300}
С одной стороны, объект ресторана легковесный и там почти ничего нет, с другой не очень круто иметь такую избыточность. 
Перебивать такую структуру в какой-то TO - накладно. 
А отдавать на фронт в виде листа таких объектов - не круто. т.к. фронтовику придется выпиливать  нужные данные.
У кого-нибудь есть мысли, чтобы одним селектом получить объект, где есть вся инфа в удобном виде ?

eageev [3:18 PM]
Начал делать выпускной проект. 1й вопрос - Зачем нам NotFoundException, когда есть javax.persistence.EntityNotFoundException?

eageev [9:42 PM]
uploaded this image: voting.jpg 


eageev [9:46 PM]
Офигеть! Чтобы это увидеть пришлось биться со Спрингом полдня. (С Boot наверн было бы быстрее). web.xml лучше не писать - выпадает ошибка, xml-конфигов не нашел, заюзал конфиги на аннотациях. С разными эксепшнами пришлось бороться..

Viktor [10:10 PM]
а в чем проблема с web.xml? Там же вроде только фильтр по желанию на кодировку и передача запросов диспетчеру спринга.


qf05 [Today at 11:15 PM]
in #graduation
а как в @NamedQuery можно сравнить даты, а именно LocalDate с LocalDatе, что бы выбрать записи с одинаковыми датами?
WHERE  r.date=:date    - не работает.


1 reply
dmitry_ov [3 minutes ago]
Думаю надо в сторону timestamp смотреть. Это тип значения в ячейке БД. Привести LocalDate к этому типу и тогда сравнение заработает


Viktor [6 days ago]
не работать может по разному, конкретнее формулируй проблему.


Viktor [6 days ago]
@dmitry_ov NamedQuery вроде использует JPQL чтобы абстрагировать от БД, думаю привязываться к ней через timestamp идея не очень


qf05 [5 days ago]
ну тут поразобравшись я выяснил что если из базы достается дата с временем большим чем 0, то и возникает эта ошибка. Как сравнить эти даты без учета времени?


Viktor [5 days ago]
достать дату и время, перевести в дату, сравнить 2 даты.


qf05 [5 days ago]
а как перевести дату и время в дату внутри NamedQuery


Viktor [5 days ago]
никак, это запрос а не операция.
Даже если как-то можно, это очень плохо смешивать логику и запрос.


Viktor [5 days ago]
Я не совсем понял, у тебя в базе у сущности DateTime а в entity просто Date?


qf05 [5 days ago]
нет у меня две LocalDate, но почему то в базу заносится дата и время, а мне для логики нужны только даты.


Viktor [5 days ago]
а в скрипте создания таблицы что создаешь? (edited)


qf05 [5 days ago]
в таблице как раз TIMESTAMP стоял, сейчас подумал, и переписал ту часть где время вообще использовалось, и в базе поставил тип DATE (ну я дебил, как сразу до этого не догадался). 
Но интересный вопрос остался, если бы я использовал LocalDateTime и по логике мне где то нужно было бы время, то как решить задачу с проверкой даты? Самое лучшее что я придумал это передавать в Qwery два параметра, первый date.atStartOfDay(), второй параметр это первый+1день и делать в запросе between.


qf05 [5 days ago]
Виктор, спасибо большое, что то я на такой фигне лютого тупника словил.


Andrey [3:09 PM]
Всем привет! Я думаю, что таблицу Меню делать не надо, так как неизвестно сколько будет блюд

ivanpobeguts [3:10 PM]
Привет, у меня такой вопрос: в задании написано, что стэк технологий: spring, hibernate. Мне интересно, можно ли использовать spring data Jpa)

Andrey [3:11 PM]
Spring Data рекомандовано и проще

Aleksei Kirillov [3:16 PM]
Мне кажется, что меню нужно, так как клиент голосует за меню

Andrey [3:23 PM]
Класс то Меню нужен - я не спорю, а вот нужна ли таблица? Или жестко прописать ,что в таблице 5 столбцов (Если мы хотим, чтобы таблица отображала несколько меню). Если предположить, что в таблице Меню отображает одно меню, то можно просто лист сделать из блюд
Ну и еще туда записать ид админа, который это меню сделал ну и еще чего нибудь

Aleksei Kirillov [3:57 PM]
Как написали "лишнего не придумывать", то у меня в таблице меню три поля :id, id ресторана, дата

Andrey [4:16 PM]
В данном случае тогда как сделать принадлежность блюда к какому-то меню? Еще одну таблицу делать id блюда, id меню?

Aleksei Kirillov [4:28 PM]
Да, плюс наименование и цена

Andrey [4:38 PM]
Вот я думаю как клиент будет создавать меню на фронт-енде? Будет кнопка выбрать блюдо и сохранить в меню и создать меню например.... Т.е. только после нажатия кнопки создать меню я записываю в таблицу (id блюда, id меню). А при нажатии "выбрать блюдо и сохранить в меню" отрабатывает фронт-енд и создается некий список. Но можно ли передать с клиента как объект список типа id блюда или это как говорится проблема фронт-енд разработчика?

Aleksei Kirillov [4:54 PM]
В постановке написано, сделать сначала основное, а потом можно накручивать функционал. Значит сначала надо просто сделать добавление нового блюда в меню. А потом уже и копирование из существующего меню добавить.

eageev [4:57 PM]
Я бы сделал общую таблицу products (или как хотите, dishes напр..) со всеми существующими блюдами, а меню уже делал как линковочную. И рестораны конечно.
хотя возможны и другие варианты - не создавать линковочную, а записывать меню в мапу или лист, сериализовать и записывать сериализованную строку в таб ресторанов для нужного ресторана.

qf05 [1:51 PM]
Всем привет, столкнулся тут с такой проблемой: в базе использую тип DATE для хранения даты, в коде использую LocalDate. И вроде всё работает, но если передать в запрос LocalDate.MAX или MIN то вылетает 
HsqlException: data exception: datetime field overflow
Подскажите, как это обойти? 
Пробовал @Column(columnDefinition = "blob") - не работает.

Pavel Zaitcev [2:00 PM]
Григорий в DateTimeUtil использует:

```public static final LocalDate MIN_DATE = LocalDate.of(1, 1, 1);
public static final LocalDate MAX_DATE = LocalDate.of(3000, 1, 1);```
Сделай аналогично.


qf05 [Yesterday at 2:04 PM]
in #graduation
Спасибо! А эти константы же можно будет потом на фронте юзать?


2 replies
Pavel Zaitcev [24 hours ago]
Чисто технически, можно. Чисто практически, к чему это? Делай по принципу: если временные параметры в запросе не заданы, значит они равны вот этим границам (MIN/MAX). Потребности прям на фронте в них нет.


qf05 [24 hours ago]
точно, просто до сервлета с контороллером я ещё не добрался, не подумал что там можно их юзать)


qf05 [2:27 PM]
А кто-нибудь придумал как сделать тесты для повторного голосования до и после 11 часов, что бы не зависеть от реального времени. Я долго искал как изменить системное время джавы, но нашел только как время винды поменять, и я думаю - это плохая идея.

Arthur [2:30 PM]
ты не должен привязываться к реальному времени

qf05 [2:41 PM]
Тоесть это нормально будет если я специально для тестов введу в репозиторий лишнюю переменную?

Viktor [9:38 PM]
@qf05 есть другие варианты

Arthur [12:13 AM]
Если включить фантазию, можно создать бин времени. В боевой системе он будет дублировать системное время, в тестовом окружении мы подсовываем бин заглушку, которую можно конфигурить как захочется.

Ilya [7:35 AM]
мне вот интересно - нужно ли отображать в истории голосования голоса, которые были изменены. а то сейчас я пилю merge и замещаю ранее сделанный голос но новый. т.е. старая запись не хранится. да и как-то делать мусорку в базе не хочется храня старые записи. а пилить отдельную таблицу для старых голосов - чото через чур.

Arthur [12:07 PM]
Мне кажется ты путаешь понятия: история голосований и история изменений.

Ilya [12:53 PM]
измененный голос - это тоже голос) так что хз. ну, я пока запилил простой случай без учета предыдущих голосов. т.к. этот функционал плюшка сверху, а не условие.

Arthur [1:26 PM]
измененный голос - сам голос бизнес значение имеет. А вот его предыдущее значение (в рамках текущей формулировки ТЗ ) - нет. 
Согласен?

Ilya [1:35 PM]
изменение мнения - это тоже действие, и возможно кому-то оно интересно. вдруг админ добавил/убрал новое блюдо и люди сменили мнение с А на Б. Было бы интересно учесть это. В общем, это уже все частные случаи. Как я сказал - в реализации я их учитывать не буду. Но логика, тем не менее, в этом есть.
и была бы история голосования в изначальной формулировке, тогда я бы не спрашивал) а так, изначально говорят, делайте самый простой вариант, но вот вам еще дополнительное условие, то хочется уточнений.